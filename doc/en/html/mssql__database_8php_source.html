<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ultimix: G:/projects/webdev/wwwroot/ultimix/packages/database/packages/mssql_database/mssql_database.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>G:/projects/webdev/wwwroot/ultimix/packages/database/packages/mssql_database/mssql_database.php</h1>  </div>
</div>
<div class="contents">
<a href="mssql__database_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003       <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment">      *     This source code is a part of the Ultimix Project. </span>
<a name="l00005"></a>00005 <span class="comment">      *     It is distributed under BSD license. All other third side source code (like tinyMCE) is distributed under </span>
<a name="l00006"></a>00006 <span class="comment">      *     it&#39;s own license wich could be found from the corresponding files or sources. </span>
<a name="l00007"></a>00007 <span class="comment">      *     This source code is provided &quot;as is&quot; without any warranties or garanties.</span>
<a name="l00008"></a>00008 <span class="comment">      *</span>
<a name="l00009"></a>00009 <span class="comment">      *     Have a nice day!</span>
<a name="l00010"></a>00010 <span class="comment">      *</span>
<a name="l00011"></a>00011 <span class="comment">      *     @url http://ultimix.sorceforge.net</span>
<a name="l00012"></a>00012 <span class="comment">      *</span>
<a name="l00013"></a>00013 <span class="comment">      *     @author Alexey &quot;gdever&quot; Dodonov</span>
<a name="l00014"></a>00014 <span class="comment">      */</span>
<a name="l00015"></a>00015       
<a name="l00016"></a><a class="code" href="mssql__database_8php.html#ab95b6141e90427e28cc6d7c10f1705b3">00016</a>       define( <span class="stringliteral">&#39;DB_ASSOC_ARRAY&#39;</span> , 1 );
<a name="l00017"></a><a class="code" href="mssql__database_8php.html#acaeb4240927648affc96a96788ea2b26">00017</a>       define( <span class="stringliteral">&#39;DB_OBJECT&#39;</span> , 2 );
<a name="l00018"></a>00018       
<a name="l00029"></a><a class="code" href="classmssql__database__1__0__0.html">00029</a>       <span class="keyword">class </span><a class="code" href="classmssql__database__1__0__0.html">mssql_database_1_0_0</a>{
<a name="l00030"></a>00030             
<a name="l00041"></a><a class="code" href="classmssql__database__1__0__0.html#ad9cee0c7bf95f6b992fdd7b162d3c45d">00041</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#ad9cee0c7bf95f6b992fdd7b162d3c45d">$Connection</a> = <span class="keyword">false</span>;
<a name="l00042"></a>00042             
<a name="l00053"></a><a class="code" href="classmssql__database__1__0__0.html#a29b06261b060cbd416e401a241d76013">00053</a>             <span class="keyword">static</span>                  <a class="code" href="classmssql__database__1__0__0.html#a29b06261b060cbd416e401a241d76013">$LockedTables</a> = <span class="keyword">false</span>;
<a name="l00054"></a>00054             
<a name="l00065"></a><a class="code" href="classmssql__database__1__0__0.html#a108dcfbbef135f73e8533a4888ab42a6">00065</a>             <span class="keyword">static</span>                  <a class="code" href="classmssql__database__1__0__0.html#a108dcfbbef135f73e8533a4888ab42a6">$LockModes</a> = <span class="keyword">false</span>;
<a name="l00066"></a>00066             
<a name="l00079"></a><a class="code" href="classmssql__database__1__0__0.html#aa2a8d02af0698b6bbeeddf18878e3487">00079</a>             <span class="keyword">static</span>                  <a class="code" href="classmssql__database__1__0__0.html#aa2a8d02af0698b6bbeeddf18878e3487">$QueryMode</a> = DB_ASSOC_ARRAY;
<a name="l00080"></a>00080             
<a name="l00091"></a><a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">00091</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">$Config</a> = <span class="keyword">false</span>;
<a name="l00092"></a>00092             
<a name="l00103"></a><a class="code" href="classmssql__database__1__0__0.html#ad019d6ecb4db4cd981fb7aeae7fbfc2c">00103</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#ad019d6ecb4db4cd981fb7aeae7fbfc2c">$Host</a>;
<a name="l00104"></a><a class="code" href="classmssql__database__1__0__0.html#a0e2ea0d42b9b800eb5bf8660587f5f7f">00104</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#a0e2ea0d42b9b800eb5bf8660587f5f7f">$Username</a>;
<a name="l00105"></a><a class="code" href="classmssql__database__1__0__0.html#ae3ac8512c0fd8924c7112671ead08cf7">00105</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#ae3ac8512c0fd8924c7112671ead08cf7">$Password</a>;
<a name="l00106"></a><a class="code" href="classmssql__database__1__0__0.html#ae10cc045c1502f148d1aa728183898e7">00106</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#ae10cc045c1502f148d1aa728183898e7">$Database</a>;
<a name="l00107"></a><a class="code" href="classmssql__database__1__0__0.html#acf6482d64a97f1ecd87f69e707e0e72f">00107</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#acf6482d64a97f1ecd87f69e707e0e72f">$TablenamePrefix</a>;
<a name="l00108"></a><a class="code" href="classmssql__database__1__0__0.html#a9281a928b88d2c6378e00aaeb261f1d3">00108</a>             var                     <a class="code" href="classmssql__database__1__0__0.html#a9281a928b88d2c6378e00aaeb261f1d3">$DBLogging</a>;
<a name="l00109"></a>00109             
<a name="l00128"></a><a class="code" href="classmssql__database__1__0__0.html#a0e96e5dadb8bce1c610ccd99dd2a134d">00128</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a0e96e5dadb8bce1c610ccd99dd2a134d">connect</a>( $ConfigRow )
<a name="l00129"></a>00129             {
<a name="l00130"></a>00130                   <span class="keywordflow">try</span>
<a name="l00131"></a>00131                   {
<a name="l00132"></a>00132                         <a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">$Config</a> = explode( <span class="stringliteral">&quot;#&quot;</span> , $ConfigRow );
<a name="l00133"></a>00133                         $this-&gt;Host = <a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">$Config</a>[ 0 ];
<a name="l00134"></a>00134                         $this-&gt;Username = <a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">$Config</a>[ 1 ];
<a name="l00135"></a>00135                         $this-&gt;Password = <a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">$Config</a>[ 2 ];
<a name="l00136"></a>00136                         $this-&gt;Database = <a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">$Config</a>[ 3 ];
<a name="l00137"></a>00137                         $this-&gt;TablenamePrefix = <a class="code" href="classmssql__database__1__0__0.html#ac2e162a2e94a6861acb555bb17919717">$Config</a>[ 4 ];
<a name="l00138"></a>00138                         
<a name="l00139"></a>00139                         $this-&gt;Connection = mssql_pconnect( $this-&gt;Host , $this-&gt;Username , $this-&gt;Password );
<a name="l00140"></a>00140                         mssql_select_db( $this-&gt;Database , $this-&gt;Connection );
<a name="l00141"></a>00141                   }
<a name="l00142"></a>00142                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00143"></a>00143                   {
<a name="l00144"></a>00144                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00145"></a>00145                   }
<a name="l00146"></a>00146             }
<a name="l00147"></a>00147             
<a name="l00166"></a><a class="code" href="classmssql__database__1__0__0.html#ac26e3605b8df54586a080a47df7f3a95">00166</a>             function                <a class="code" href="classmssql__database__1__0__0.html#ac26e3605b8df54586a080a47df7f3a95">get_connection</a>( $ForceReconnect = <span class="keyword">false</span> )
<a name="l00167"></a>00167             {
<a name="l00168"></a>00168                   <span class="keywordflow">try</span>
<a name="l00169"></a>00169                   {
<a name="l00170"></a>00170                         <span class="keywordflow">if</span>( $this-&gt;Connection === <span class="keyword">false</span> || $ForceReconnect ===<span class="keyword">true</span> )
<a name="l00171"></a>00171                         {
<a name="l00172"></a>00172                               <span class="keywordflow">if</span>( $this-&gt;Connection !== <span class="keyword">false</span> )
<a name="l00173"></a>00173                               {
<a name="l00174"></a>00174                                     mssql_close( $this-&gt;Connection );
<a name="l00175"></a>00175                               }
<a name="l00176"></a>00176                               $DBConfigSet = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;database::db_config_set&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00177"></a>00177                               $DBConfigSet-&gt;load_config( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cf_mssql_database&#39;</span> );
<a name="l00178"></a>00178                               $this-&gt;Connection = $DBConfigSet-&gt;connect( $this );
<a name="l00179"></a>00179                               <span class="keywordflow">if</span>( mssql_get_last_message() !== <span class="keyword">false</span> )
<a name="l00180"></a>00180                               {
<a name="l00181"></a>00181                                     <span class="keywordflow">throw</span>( 
<a name="l00182"></a>00182                                           <span class="keyword">new</span> Exception( 
<a name="l00183"></a>00183                                                 <span class="stringliteral">&#39;An error occured while setting connection to the database &#39;</span>.mssql_get_last_message()
<a name="l00184"></a>00184                                           )
<a name="l00185"></a>00185                                     );
<a name="l00186"></a>00186                               }
<a name="l00187"></a>00187                               $this-&gt;Connection-&gt;query( <span class="stringliteral">&#39;SET AUTOCOMMIT = 0&#39;</span> );
<a name="l00188"></a>00188                               $this-&gt;Connection-&gt;query( <span class="stringliteral">&#39;SET NAMES utf8&#39;</span> );
<a name="l00189"></a>00189                         }
<a name="l00190"></a>00190                         <span class="keywordflow">return</span>( $this-&gt;Connection );
<a name="l00191"></a>00191                   }
<a name="l00192"></a>00192                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00193"></a>00193                   {
<a name="l00194"></a>00194                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00195"></a>00195                   }
<a name="l00196"></a>00196             }
<a name="l00197"></a>00197             
<a name="l00216"></a><a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">00216</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( $Query )
<a name="l00217"></a>00217             {
<a name="l00218"></a>00218                   <span class="keywordflow">try</span>
<a name="l00219"></a>00219                   {
<a name="l00220"></a>00220                         <a class="code" href="classmssql__database__1__0__0.html#ad9cee0c7bf95f6b992fdd7b162d3c45d">$Connection</a> = $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#ac26e3605b8df54586a080a47df7f3a95">get_connection</a>();
<a name="l00221"></a>00221                         
<a name="l00222"></a>00222                         $Query = str_replace( <span class="stringliteral">&#39;umx_&#39;</span> , $this-&gt;TablenamePrefix , $Query );
<a name="l00223"></a>00223                   
<a name="l00224"></a>00224                         $Result = <a class="code" href="classmssql__database__1__0__0.html#ad9cee0c7bf95f6b992fdd7b162d3c45d">$Connection</a>-&gt;query( $Query );
<a name="l00225"></a>00225                         
<a name="l00226"></a>00226                         <span class="keywordflow">if</span>( <a class="code" href="classmssql__database__1__0__0.html#ad9cee0c7bf95f6b992fdd7b162d3c45d">$Connection</a>-&gt;errno !== 0 )
<a name="l00227"></a>00227                         {
<a name="l00228"></a>00228                               <span class="keywordflow">throw</span>( <span class="keyword">new</span> Exception( <span class="stringliteral">&#39;An error occured while query execution &#39;</span>.<a class="code" href="classmssql__database__1__0__0.html#ad9cee0c7bf95f6b992fdd7b162d3c45d">$Connection</a>-&gt;error ) );
<a name="l00229"></a>00229                         }
<a name="l00230"></a>00230                         
<a name="l00231"></a>00231                         <span class="keywordflow">return</span>( $Result );
<a name="l00232"></a>00232                   }
<a name="l00233"></a>00233                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00234"></a>00234                   {
<a name="l00235"></a>00235                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00236"></a>00236                   }
<a name="l00237"></a>00237             }
<a name="l00238"></a>00238             
<a name="l00257"></a><a class="code" href="classmssql__database__1__0__0.html#adf105fb130a7bcf91a218cb71383b763">00257</a>             function                <a class="code" href="classmssql__database__1__0__0.html#adf105fb130a7bcf91a218cb71383b763">query_as</a>( $theQueryMode )
<a name="l00258"></a>00258             {
<a name="l00259"></a>00259                   <span class="keywordflow">try</span>
<a name="l00260"></a>00260                   {
<a name="l00261"></a>00261                         self::$QueryMode = $theQueryMode;
<a name="l00262"></a>00262                   }
<a name="l00263"></a>00263                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00264"></a>00264                   {
<a name="l00265"></a>00265                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00266"></a>00266                   }
<a name="l00267"></a>00267             }
<a name="l00268"></a>00268             
<a name="l00299"></a><a class="code" href="classmssql__database__1__0__0.html#af4ba8b7dff98b096f3ffa9548ad7118c">00299</a>             function                <a class="code" href="classmssql__database__1__0__0.html#af4ba8b7dff98b096f3ffa9548ad7118c">select</a>( $What , $Tables , $Condition = <span class="stringliteral">&#39;1 = 1&#39;</span> )
<a name="l00300"></a>00300             {
<a name="l00301"></a>00301                   <span class="keywordflow">try</span>
<a name="l00302"></a>00302                   {
<a name="l00303"></a>00303                         $Result = $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&quot;SELECT $What FROM $Tables WHERE $Condition&quot;</span> );
<a name="l00304"></a>00304 
<a name="l00305"></a>00305                         <span class="keywordflow">return</span>( $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a13280dd843e6580477936a03fc0ef733">fetch_results</a>( $Result ) );
<a name="l00306"></a>00306                   }
<a name="l00307"></a>00307                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00308"></a>00308                   {
<a name="l00309"></a>00309                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00310"></a>00310                   }
<a name="l00311"></a>00311             }
<a name="l00312"></a>00312             
<a name="l00335"></a><a class="code" href="classmssql__database__1__0__0.html#a13280dd843e6580477936a03fc0ef733">00335</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a13280dd843e6580477936a03fc0ef733">fetch_results</a>( $Result )
<a name="l00336"></a>00336             {
<a name="l00337"></a>00337                   <span class="keywordflow">try</span>
<a name="l00338"></a>00338                   {                       
<a name="l00339"></a>00339                         $RetValues = array();
<a name="l00340"></a>00340                               
<a name="l00341"></a>00341                         <span class="keywordflow">for</span>( $i = 0; $i &lt; $Result-&gt;num_rows ; $i++ )
<a name="l00342"></a>00342                         {
<a name="l00343"></a>00343                               <span class="keywordflow">if</span>( self::$QueryMode == <a class="code" href="database_8php.html#ab95b6141e90427e28cc6d7c10f1705b3">DB_ASSOC_ARRAY</a> )
<a name="l00344"></a>00344                               {
<a name="l00345"></a>00345                                     $RetValues [] = $Result-&gt;fetch_array( MYSQLI_ASSOC );
<a name="l00346"></a>00346                               }
<a name="l00347"></a>00347                               elseif( self::$QueryMode == <a class="code" href="database_8php.html#acaeb4240927648affc96a96788ea2b26">DB_OBJECT</a> )
<a name="l00348"></a>00348                               {
<a name="l00349"></a>00349                                     $RetValues [] = $Result-&gt;fetch_object();
<a name="l00350"></a>00350                               }
<a name="l00351"></a>00351                         }
<a name="l00352"></a>00352                               
<a name="l00353"></a>00353                         $Result-&gt;close();
<a name="l00354"></a>00354 
<a name="l00355"></a>00355                         <span class="keywordflow">return</span>( $RetValues );
<a name="l00356"></a>00356                   }
<a name="l00357"></a>00357                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00358"></a>00358                   {
<a name="l00359"></a>00359                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00360"></a>00360                   }
<a name="l00361"></a>00361             }
<a name="l00362"></a>00362             
<a name="l00389"></a><a class="code" href="classmssql__database__1__0__0.html#ace8196a67308124a7cbf3dfe3f877881">00389</a>             function                <a class="code" href="classmssql__database__1__0__0.html#ace8196a67308124a7cbf3dfe3f877881">insert</a>( $Table , $Fields , $Values )
<a name="l00390"></a>00390             {
<a name="l00391"></a>00391                   <span class="keywordflow">try</span>
<a name="l00392"></a>00392                   {
<a name="l00393"></a>00393                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&quot;INSERT INTO $Table ( $Fields ) VALUES ( $Values )&quot;</span> );
<a name="l00394"></a>00394                   }
<a name="l00395"></a>00395                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00396"></a>00396                   {
<a name="l00397"></a>00397                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00398"></a>00398                   }
<a name="l00399"></a>00399             }
<a name="l00400"></a>00400             
<a name="l00423"></a><a class="code" href="classmssql__database__1__0__0.html#a45afb41c468a328d9778e8e6b0c846c4">00423</a>             function                <span class="keyword">delete</span>( $Table , $Condition = <span class="stringliteral">&#39;1 = 1&#39;</span> )
<a name="l00424"></a>00424             {
<a name="l00425"></a>00425                   <span class="keywordflow">try</span>
<a name="l00426"></a>00426                   {
<a name="l00427"></a>00427                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&quot;DELETE FROM $Table WHERE $Condition&quot;</span> );
<a name="l00428"></a>00428                   }
<a name="l00429"></a>00429                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00430"></a>00430                   {
<a name="l00431"></a>00431                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00432"></a>00432                   }
<a name="l00433"></a>00433             }
<a name="l00434"></a>00434             
<a name="l00465"></a><a class="code" href="classmssql__database__1__0__0.html#a3e84056248d9894f143cb7b360d167de">00465</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a3e84056248d9894f143cb7b360d167de">update</a>( $Table , $Fields , $Values , $Condition = <span class="stringliteral">&#39;1 = 1&#39;</span> )
<a name="l00466"></a>00466             {
<a name="l00467"></a>00467                   <span class="keywordflow">try</span>
<a name="l00468"></a>00468                   {
<a name="l00469"></a>00469                         $SubQuery = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00470"></a>00470                         
<a name="l00471"></a>00471                         <span class="keywordflow">for</span>( $i = 0 ; $i &lt; count( $Fields ) - 1 ; $i++ )
<a name="l00472"></a>00472                         {
<a name="l00473"></a>00473                               $SubQuery .= $Fields[ $i ].<span class="stringliteral">&#39; = &#39;</span>.$Values[ $i ].<span class="stringliteral">&#39; , &#39;</span>;
<a name="l00474"></a>00474                         }
<a name="l00475"></a>00475                         $SubQuery .= $Fields[ count( $Fields ) - 1 ].<span class="stringliteral">&#39; = &#39;</span>.$Values[ count( $Fields ) - 1 ];
<a name="l00476"></a>00476                         
<a name="l00477"></a>00477                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&quot;UPDATE $Table SET $SubQuery WHERE $Condition&quot;</span> );
<a name="l00478"></a>00478                   }
<a name="l00479"></a>00479                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00480"></a>00480                   {
<a name="l00481"></a>00481                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00482"></a>00482                   }
<a name="l00483"></a>00483             }
<a name="l00484"></a>00484             
<a name="l00507"></a><a class="code" href="classmssql__database__1__0__0.html#a31e6529ed04211e9b1b4b808446af47a">00507</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a31e6529ed04211e9b1b4b808446af47a">create</a>( $Table , $FirstIndexField = <span class="stringliteral">&#39;id&#39;</span> )
<a name="l00508"></a>00508             {
<a name="l00509"></a>00509                   <span class="keywordflow">try</span>
<a name="l00510"></a>00510                   {
<a name="l00511"></a>00511                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( 
<a name="l00512"></a>00512                               <span class="stringliteral">&quot;CREATE TABLE `$Table` ( `$FirstIndexField` INTEGER UNSIGNED NOT NULL DEFAULT NULL &quot;</span>.
<a name="l00513"></a>00513                                     <span class="stringliteral">&quot;AUTO_INCREMENT , PRIMARY KEY ( `$FirstIndexField` ) )&quot;</span>
<a name="l00514"></a>00514                         );
<a name="l00515"></a>00515                   }
<a name="l00516"></a>00516                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00517"></a>00517                   {
<a name="l00518"></a>00518                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00519"></a>00519                   }
<a name="l00520"></a>00520             }
<a name="l00521"></a>00521             
<a name="l00540"></a><a class="code" href="classmssql__database__1__0__0.html#aa781c13ec985a57829a2c7b2c1298d02">00540</a>             function                <a class="code" href="classmssql__database__1__0__0.html#aa781c13ec985a57829a2c7b2c1298d02">drop</a>( $Table )
<a name="l00541"></a>00541             {
<a name="l00542"></a>00542                   <span class="keywordflow">try</span>
<a name="l00543"></a>00543                   {
<a name="l00544"></a>00544                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&quot;DROP TABLE $Table&quot;</span> );
<a name="l00545"></a>00545                   }
<a name="l00546"></a>00546                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00547"></a>00547                   {
<a name="l00548"></a>00548                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00549"></a>00549                   }
<a name="l00550"></a>00550             }
<a name="l00551"></a>00551             
<a name="l00582"></a><a class="code" href="classmssql__database__1__0__0.html#aae9890f7d450e4b9e346fd620660990f">00582</a>             function                <a class="code" href="classmssql__database__1__0__0.html#aae9890f7d450e4b9e346fd620660990f">add_column</a>( $Table , $ColumnName , $Type , $Mode = <span class="stringliteral">&#39;NOT NULL AFTER `id`&#39;</span> )
<a name="l00583"></a>00583             {
<a name="l00584"></a>00584                   <span class="keywordflow">try</span>
<a name="l00585"></a>00585                   {
<a name="l00586"></a>00586                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&quot;ALTER TABLE `$Table` ADD COLUMN `$ColumnName` $Type $Mode&quot;</span> );
<a name="l00587"></a>00587                   }
<a name="l00588"></a>00588                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00589"></a>00589                   {
<a name="l00590"></a>00590                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00591"></a>00591                   }
<a name="l00592"></a>00592             }
<a name="l00593"></a>00593             
<a name="l00616"></a><a class="code" href="classmssql__database__1__0__0.html#a91a17d943d9065bae6c6f65aa292fa1b">00616</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a91a17d943d9065bae6c6f65aa292fa1b">drop_column</a>( $Table , $ColumnName )
<a name="l00617"></a>00617             {
<a name="l00618"></a>00618                   <span class="keywordflow">try</span>
<a name="l00619"></a>00619                   {
<a name="l00620"></a>00620                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&quot;ALTER TABLE `$Table` DROP COLUMN `$ColumnName`&quot;</span> );
<a name="l00621"></a>00621                   }
<a name="l00622"></a>00622                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00623"></a>00623                   {
<a name="l00624"></a>00624                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00625"></a>00625                   }
<a name="l00626"></a>00626             }
<a name="l00627"></a>00627             
<a name="l00650"></a><a class="code" href="classmssql__database__1__0__0.html#a85c4301faecdaf42f198bfe05d87d503">00650</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a85c4301faecdaf42f198bfe05d87d503">lock</a>( $Tables , $Modes )
<a name="l00651"></a>00651             {
<a name="l00652"></a>00652                   <span class="keywordflow">try</span>
<a name="l00653"></a>00653                   {
<a name="l00654"></a>00654                         <span class="keywordflow">throw</span>( <span class="keyword">new</span> Exception( <span class="stringliteral">&quot;Table locking unavailable&quot;</span> ) );
<a name="l00655"></a>00655                   }
<a name="l00656"></a>00656                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00657"></a>00657                   {
<a name="l00658"></a>00658                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00659"></a>00659                   }
<a name="l00660"></a>00660             }
<a name="l00661"></a>00661             
<a name="l00676"></a><a class="code" href="classmssql__database__1__0__0.html#afb061ecbff1e66db62b9eddfea6e915f">00676</a>             function                <a class="code" href="classmssql__database__1__0__0.html#afb061ecbff1e66db62b9eddfea6e915f">unlock</a>()
<a name="l00677"></a>00677             {
<a name="l00678"></a>00678                   <span class="keywordflow">try</span>
<a name="l00679"></a>00679                   {
<a name="l00680"></a>00680                         <span class="keywordflow">throw</span>( <span class="keyword">new</span> Exception( <span class="stringliteral">&quot;Table locking unavailable&quot;</span> ) );
<a name="l00681"></a>00681                   }
<a name="l00682"></a>00682                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00683"></a>00683                   {
<a name="l00684"></a>00684                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00685"></a>00685                   }
<a name="l00686"></a>00686             }
<a name="l00687"></a>00687             
<a name="l00706"></a><a class="code" href="classmssql__database__1__0__0.html#a747ff948167d2a17416a7ed9a144a53a">00706</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a747ff948167d2a17416a7ed9a144a53a">savepoint</a>( $Savepoint )
<a name="l00707"></a>00707             {
<a name="l00708"></a>00708                   <span class="keywordflow">try</span>
<a name="l00709"></a>00709                   {
<a name="l00710"></a>00710                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&#39;SAVEPOINT &#39;</span>.$Savepoint );
<a name="l00711"></a>00711                   }
<a name="l00712"></a>00712                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00713"></a>00713                   {
<a name="l00714"></a>00714                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00715"></a>00715                   }
<a name="l00716"></a>00716             }
<a name="l00717"></a>00717             
<a name="l00736"></a><a class="code" href="classmssql__database__1__0__0.html#ad7b7e0fb9407e143ab7b0bcd8f9fa20e">00736</a>             function                <a class="code" href="classmssql__database__1__0__0.html#ad7b7e0fb9407e143ab7b0bcd8f9fa20e">rollback</a>( $Savepoint )
<a name="l00737"></a>00737             {
<a name="l00738"></a>00738                   <span class="keywordflow">try</span>
<a name="l00739"></a>00739                   {
<a name="l00740"></a>00740                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&#39;ROLLBACK TO SAVEPOINT &#39;</span>.$Savepoint );
<a name="l00741"></a>00741                   }
<a name="l00742"></a>00742                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00743"></a>00743                   {
<a name="l00744"></a>00744                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00745"></a>00745                   }
<a name="l00746"></a>00746             }
<a name="l00747"></a>00747             
<a name="l00762"></a><a class="code" href="classmssql__database__1__0__0.html#a6f5e7602837a6f85fcb02751c073b181">00762</a>             function                <a class="code" href="classmssql__database__1__0__0.html#a6f5e7602837a6f85fcb02751c073b181">transaction</a>()
<a name="l00763"></a>00763             {
<a name="l00764"></a>00764                   <span class="keywordflow">try</span>
<a name="l00765"></a>00765                   {
<a name="l00766"></a>00766                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&#39;START TRANSACTION&#39;</span> );
<a name="l00767"></a>00767                   }
<a name="l00768"></a>00768                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00769"></a>00769                   {
<a name="l00770"></a>00770                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00771"></a>00771                   }
<a name="l00772"></a>00772             }
<a name="l00773"></a>00773             
<a name="l00788"></a><a class="code" href="classmssql__database__1__0__0.html#af5674c27d4a92f6228565010eacbb9cb">00788</a>             function                <a class="code" href="classmssql__database__1__0__0.html#af5674c27d4a92f6228565010eacbb9cb">commit</a>()
<a name="l00789"></a>00789             {
<a name="l00790"></a>00790                   <span class="keywordflow">try</span>
<a name="l00791"></a>00791                   {
<a name="l00792"></a>00792                         $this-&gt;<a class="code" href="classmssql__database__1__0__0.html#a6b5765262de7bbecc5aab15ec52c101a">query</a>( <span class="stringliteral">&#39;COMMIT&#39;</span> );
<a name="l00793"></a>00793                   }
<a name="l00794"></a>00794                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00795"></a>00795                   {
<a name="l00796"></a>00796                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00797"></a>00797                   }
<a name="l00798"></a>00798             }
<a name="l00799"></a>00799       }
<a name="l00800"></a>00800 
<a name="l00801"></a>00801 ?&gt;
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 3 2011 14:49:47 for ultimix by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
