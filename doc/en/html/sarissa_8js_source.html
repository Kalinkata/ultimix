<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ultimix: packages/gui/packages/jstree/include/js/lib/sarissa.js Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ultimix
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sarissa_8js_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">sarissa.js</div>  </div>
</div><!--header-->
<div class="contents">
<a href="sarissa_8js.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/* * ====================================================================</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * About: This a a compressed JS file from the Sarissa library. </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * see http://dev.abiss.gr/sarissa</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Copyright: Manos Batsis, http://dev.abiss.gr</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Licence:</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Sarissa is free software distributed under the GNU GPL version 2 </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * or higher, GNU LGPL version 2.1 or higher and Apache Software </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * License 2.0 or higher. The licenses are available online see: </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * http://www.gnu.org  </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * http://www.apache.org</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE </span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * ====================================================================*/</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">   25</a></span>&#160;<span class="keyword">function</span> <a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>(){}</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a0cb62a5a6c23c9019187549f988b4419">   26</a></span>&#160;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.VERSION=<span class="stringliteral">&quot;0.9.9.4&quot;</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_OK=<span class="stringliteral">&quot;Document contains no parsing errors&quot;</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_EMPTY=<span class="stringliteral">&quot;Document is empty&quot;</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_UNKNOWN_ERROR=<span class="stringliteral">&quot;Not well-formed or other error&quot;</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.IS_ENABLED_TRANSFORM_NODE=<span class="keyword">false</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.REMOTE_CALL_FLAG=<span class="stringliteral">&quot;gr.abiss.sarissa.REMOTE_CALL_FLAG&quot;</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._lastUniqueSuffix=0;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._getUniqueSuffix=<span class="keyword">function</span>(){<span class="keywordflow">return</span> <a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._lastUniqueSuffix++;};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IEPREFIX4XSLPARAM=<span class="stringliteral">&quot;&quot;</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_IMPLEMENTATION=document.implementation&amp;&amp;<span class="keyword">true</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_CREATE_DOCUMENT=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_IMPLEMENTATION&amp;&amp;document.implementation.createDocument;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_FEATURE=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_IMPLEMENTATION&amp;&amp;document.implementation.hasFeature;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_MOZ=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_CREATE_DOCUMENT&amp;&amp;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_FEATURE;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_SAFARI=navigator.userAgent.toLowerCase().indexOf(<span class="stringliteral">&quot;safari&quot;</span>)!=-1||navigator.userAgent.toLowerCase().indexOf(<span class="stringliteral">&quot;konqueror&quot;</span>)!=-1;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_SAFARI_OLD=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_SAFARI&amp;&amp;(parseInt((navigator.userAgent.match(/AppleWebKit\/(\d+)/)||{})[1],10)&lt;420);<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_IE=document.all&amp;&amp;window.ActiveXObject&amp;&amp;navigator.userAgent.toLowerCase().indexOf(<span class="stringliteral">&quot;msie&quot;</span>)&gt;-1&amp;&amp;navigator.userAgent.toLowerCase().indexOf(<span class="stringliteral">&quot;opera&quot;</span>)==-1;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_OPERA=navigator.userAgent.toLowerCase().indexOf(<span class="stringliteral">&quot;opera&quot;</span>)!=-1;<span class="keywordflow">if</span>(!window.Node||!Node.ELEMENT_NODE){Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};}</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="code" href="sarissa_8js.html#ac21bb4c3214536de1a479af39be268d1">   27</a></span>&#160;<span class="keywordflow">if</span>(<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_SAFARI_OLD){HTMLHtmlElement=document.createElement(<span class="stringliteral">&quot;html&quot;</span>).constructor;Node=HTMLElement={};HTMLElement.prototype=HTMLHtmlElement.__proto__.__proto__;HTMLDocument=Document=document.constructor;var x=<span class="keyword">new</span> DOMParser();XMLDocument=x.constructor;Element=x.parseFromString(<span class="stringliteral">&quot;&lt;Single /&gt;&quot;</span>,<span class="stringliteral">&quot;text/xml&quot;</span>).documentElement.constructor;x=null;}</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a302b22879bcc48bedfe4eb4a9ebb45d5">   28</a></span>&#160;<span class="keywordflow">if</span>(typeof XMLDocument==<span class="stringliteral">&quot;undefined&quot;</span>&amp;&amp;typeof Document!=<span class="stringliteral">&quot;undefined&quot;</span>){XMLDocument=Document;}</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keywordflow">if</span>(<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_IE){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IEPREFIX4XSLPARAM=<span class="stringliteral">&quot;xsl:&quot;</span>;var _SARISSA_DOM_PROGID=<span class="stringliteral">&quot;&quot;</span>;var _SARISSA_XMLHTTP_PROGID=<span class="stringliteral">&quot;&quot;</span>;var _SARISSA_DOM_XMLWRITER=<span class="stringliteral">&quot;&quot;</span>;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.pickRecentProgID=<span class="keyword">function</span>(idList){var bFound=<span class="keyword">false</span>,e;var o2Store;<span class="keywordflow">for</span>(var i=0;i&lt;idList.length&amp;&amp;!bFound;i++){<span class="keywordflow">try</span>{var oDoc=<span class="keyword">new</span> ActiveXObject(idList[i]);o2Store=idList[i];bFound=<span class="keyword">true</span>;}<span class="keywordflow">catch</span>(objException){e=objException;}}</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keywordflow">if</span>(!bFound){<span class="keywordflow">throw</span><span class="stringliteral">&quot;Could not retrieve a valid progID of Class: &quot;</span>+idList[idList.length-1]+<span class="stringliteral">&quot;. (original exception: &quot;</span>+e+<span class="stringliteral">&quot;)&quot;</span>;}</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;idList=null;<span class="keywordflow">return</span> o2Store;};_SARISSA_DOM_PROGID=null;_SARISSA_THREADEDDOM_PROGID=null;_SARISSA_XSLTEMPLATE_PROGID=null;_SARISSA_XMLHTTP_PROGID=null;XMLHttpRequest=<span class="keyword">function</span>(){<span class="keywordflow">if</span>(!_SARISSA_XMLHTTP_PROGID){_SARISSA_XMLHTTP_PROGID=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.pickRecentProgID([<span class="stringliteral">&quot;Msxml2.XMLHTTP.6.0&quot;</span>,<span class="stringliteral">&quot;MSXML2.XMLHTTP.3.0&quot;</span>,<span class="stringliteral">&quot;MSXML2.XMLHTTP&quot;</span>,<span class="stringliteral">&quot;Microsoft.XMLHTTP&quot;</span>]);}</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keywordflow">return</span> <span class="keyword">new</span> ActiveXObject(_SARISSA_XMLHTTP_PROGID);};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument=<span class="keyword">function</span>(sUri,sName){<span class="keywordflow">if</span>(!_SARISSA_DOM_PROGID){_SARISSA_DOM_PROGID=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.pickRecentProgID([<span class="stringliteral">&quot;Msxml2.DOMDocument.6.0&quot;</span>,<span class="stringliteral">&quot;Msxml2.DOMDocument.3.0&quot;</span>,<span class="stringliteral">&quot;MSXML2.DOMDocument&quot;</span>,<span class="stringliteral">&quot;MSXML.DOMDocument&quot;</span>,<span class="stringliteral">&quot;Microsoft.XMLDOM&quot;</span>]);}</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;var oDoc=<span class="keyword">new</span> ActiveXObject(_SARISSA_DOM_PROGID);<span class="keywordflow">if</span>(sName){var prefix=<span class="stringliteral">&quot;&quot;</span>;<span class="keywordflow">if</span>(sUri){<span class="keywordflow">if</span>(sName.indexOf(<span class="stringliteral">&quot;:&quot;</span>)&gt;1){prefix=sName.substring(0,sName.indexOf(<span class="stringliteral">&quot;:&quot;</span>));sName=sName.substring(sName.indexOf(<span class="stringliteral">&quot;:&quot;</span>)+1);}<span class="keywordflow">else</span>{prefix=<span class="stringliteral">&quot;a&quot;</span>+<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._getUniqueSuffix();}}</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keywordflow">if</span>(sUri){oDoc.loadXML(<span class="charliteral">&#39;&lt;&#39;</span>+prefix+<span class="charliteral">&#39;:&#39;</span>+sName+<span class="stringliteral">&quot; xmlns:&quot;</span>+prefix+<span class="stringliteral">&quot;=\&quot;&quot;</span>+sUri+<span class="stringliteral">&quot;\&quot;&quot;</span>+<span class="stringliteral">&quot; /&gt;&quot;</span>);}<span class="keywordflow">else</span>{oDoc.loadXML(<span class="charliteral">&#39;&lt;&#39;</span>+sName+<span class="stringliteral">&quot; /&gt;&quot;</span>);}}</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keywordflow">return</span> oDoc;};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getParseErrorText=<span class="keyword">function</span>(oDoc){var parseErrorText=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_OK;<span class="keywordflow">if</span>(oDoc&amp;&amp;oDoc.parseError&amp;&amp;oDoc.parseError.errorCode&amp;&amp;oDoc.parseError.errorCode!=0){parseErrorText=<span class="stringliteral">&quot;XML Parsing Error: &quot;</span>+oDoc.parseError.reason+<span class="stringliteral">&quot;\nLocation: &quot;</span>+oDoc.parseError.url+<span class="stringliteral">&quot;\nLine Number &quot;</span>+oDoc.parseError.line+<span class="stringliteral">&quot;, Column &quot;</span>+</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;oDoc.parseError.linepos+<span class="stringliteral">&quot;:\n&quot;</span>+oDoc.parseError.srcText+<span class="stringliteral">&quot;\n&quot;</span>;<span class="keywordflow">for</span>(var i=0;i&lt;oDoc.parseError.linepos;i++){parseErrorText+=<span class="stringliteral">&quot;-&quot;</span>;}</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;parseErrorText+=<span class="stringliteral">&quot;^\n&quot;</span>;}</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keywordflow">else</span> <span class="keywordflow">if</span>(oDoc.documentElement===null){parseErrorText=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_EMPTY;}</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keywordflow">return</span> parseErrorText;};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.setXpathNamespaces=<span class="keyword">function</span>(oDoc,sNsSet){oDoc.setProperty(<span class="stringliteral">&quot;SelectionLanguage&quot;</span>,<span class="stringliteral">&quot;XPath&quot;</span>);oDoc.setProperty(<span class="stringliteral">&quot;SelectionNamespaces&quot;</span>,sNsSet);};XSLTProcessor=<span class="keyword">function</span>(){<span class="keywordflow">if</span>(!_SARISSA_XSLTEMPLATE_PROGID){_SARISSA_XSLTEMPLATE_PROGID=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.pickRecentProgID([<span class="stringliteral">&quot;Msxml2.XSLTemplate.6.0&quot;</span>,<span class="stringliteral">&quot;MSXML2.XSLTemplate.3.0&quot;</span>]);}</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;this.<span class="keyword">template</span>=<span class="keyword">new</span> ActiveXObject(_SARISSA_XSLTEMPLATE_PROGID);this.processor=null;};XSLTProcessor.prototype.importStylesheet=<span class="keyword">function</span>(xslDoc){<span class="keywordflow">if</span>(!_SARISSA_THREADEDDOM_PROGID){_SARISSA_THREADEDDOM_PROGID=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.pickRecentProgID([<span class="stringliteral">&quot;MSXML2.FreeThreadedDOMDocument.6.0&quot;</span>,<span class="stringliteral">&quot;MSXML2.FreeThreadedDOMDocument.3.0&quot;</span>]);}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;xslDoc.setProperty(<span class="stringliteral">&quot;SelectionLanguage&quot;</span>,<span class="stringliteral">&quot;XPath&quot;</span>);xslDoc.setProperty(<span class="stringliteral">&quot;SelectionNamespaces&quot;</span>,<span class="stringliteral">&quot;xmlns:xsl=&#39;http://www.w3.org/1999/XSL/Transform&#39;&quot;</span>);var converted=<span class="keyword">new</span> ActiveXObject(_SARISSA_THREADEDDOM_PROGID);<span class="keywordflow">try</span>{converted.resolveExternals=<span class="keyword">true</span>;converted.setProperty(<span class="stringliteral">&quot;AllowDocumentFunction&quot;</span>,<span class="keyword">true</span>);}</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordflow">catch</span>(e){}</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordflow">if</span>(xslDoc.url&amp;&amp;xslDoc.selectSingleNode(<span class="stringliteral">&quot;//xsl:*[local-name() = &#39;import&#39; or local-name() = &#39;include&#39;]&quot;</span>)!=null){converted.async=<span class="keyword">false</span>;converted.load(xslDoc.url);}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keywordflow">else</span>{converted.loadXML(xslDoc.xml);}</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;converted.setProperty(<span class="stringliteral">&quot;SelectionNamespaces&quot;</span>,<span class="stringliteral">&quot;xmlns:xsl=&#39;http://www.w3.org/1999/XSL/Transform&#39;&quot;</span>);var output=converted.selectSingleNode(<span class="stringliteral">&quot;//xsl:output&quot;</span>);<span class="keywordflow">if</span>(output){this.outputMethod=output.getAttribute(<span class="stringliteral">&quot;method&quot;</span>);}</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordflow">else</span>{<span class="keyword">delete</span> this.outputMethod;}</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;this.<span class="keyword">template</span>.stylesheet=converted;this.processor=this.<span class="keyword">template</span>.createProcessor();this.paramsSet=[];};XSLTProcessor.prototype.transformToDocument=<span class="keyword">function</span>(sourceDoc){var outDoc;<span class="keywordflow">if</span>(_SARISSA_THREADEDDOM_PROGID){this.processor.input=sourceDoc;outDoc=<span class="keyword">new</span> ActiveXObject(_SARISSA_DOM_PROGID);this.processor.output=outDoc;this.processor.transform();<span class="keywordflow">return</span> outDoc;}</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keywordflow">else</span>{<span class="keywordflow">if</span>(!_SARISSA_DOM_XMLWRITER){_SARISSA_DOM_XMLWRITER=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.pickRecentProgID([<span class="stringliteral">&quot;Msxml2.MXXMLWriter.6.0&quot;</span>,<span class="stringliteral">&quot;Msxml2.MXXMLWriter.3.0&quot;</span>,<span class="stringliteral">&quot;MSXML2.MXXMLWriter&quot;</span>,<span class="stringliteral">&quot;MSXML.MXXMLWriter&quot;</span>,<span class="stringliteral">&quot;Microsoft.XMLDOM&quot;</span>]);}</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;this.processor.input=sourceDoc;outDoc=<span class="keyword">new</span> ActiveXObject(_SARISSA_DOM_XMLWRITER);this.processor.output=outDoc;this.processor.transform();var oDoc=<span class="keyword">new</span> ActiveXObject(_SARISSA_DOM_PROGID);oDoc.loadXML(outDoc.output+<span class="stringliteral">&quot;&quot;</span>);<span class="keywordflow">return</span> oDoc;}};XSLTProcessor.prototype.transformToFragment=<span class="keyword">function</span>(sourceDoc,ownerDoc){this.processor.input=sourceDoc;this.processor.transform();var s=this.processor.output;var f=ownerDoc.createDocumentFragment();var container;<span class="keywordflow">if</span>(this.outputMethod==<span class="stringliteral">&#39;text&#39;</span>){f.appendChild(ownerDoc.createTextNode(s));}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(ownerDoc.body&amp;&amp;ownerDoc.body.innerHTML){container=ownerDoc.createElement(<span class="stringliteral">&#39;div&#39;</span>);container.innerHTML=s;<span class="keywordflow">while</span>(container.hasChildNodes()){f.appendChild(container.firstChild);}}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordflow">else</span>{var oDoc=<span class="keyword">new</span> ActiveXObject(_SARISSA_DOM_PROGID);<span class="keywordflow">if</span>(s.substring(0,5)==<span class="stringliteral">&#39;&lt;?xml&#39;</span>){s=s.substring(s.indexOf(<span class="stringliteral">&#39;?&gt;&#39;</span>)+2);}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;var xml=<span class="stringliteral">&#39;&#39;</span>.concat(<span class="stringliteral">&#39;&lt;my&gt;&#39;</span>,s,<span class="stringliteral">&#39;&lt;/my&gt;&#39;</span>);oDoc.loadXML(xml);container=oDoc.documentElement;<span class="keywordflow">while</span>(container.hasChildNodes()){f.appendChild(container.firstChild);}}</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordflow">return</span> f;};XSLTProcessor.prototype.setParameter=<span class="keyword">function</span>(nsURI,name,value){value=value?value:<span class="stringliteral">&quot;&quot;</span>;<span class="keywordflow">if</span>(nsURI){this.processor.addParameter(name,value,nsURI);}<span class="keywordflow">else</span>{this.processor.addParameter(name,value);}</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;nsURI=<span class="stringliteral">&quot;&quot;</span>+(nsURI||<span class="stringliteral">&quot;&quot;</span>);<span class="keywordflow">if</span>(!this.paramsSet[nsURI]){this.paramsSet[nsURI]=[];}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;this.paramsSet[nsURI][name]=value;};XSLTProcessor.prototype.getParameter=<span class="keyword">function</span>(nsURI,name){nsURI=<span class="stringliteral">&quot;&quot;</span>+(nsURI||<span class="stringliteral">&quot;&quot;</span>);<span class="keywordflow">if</span>(this.paramsSet[nsURI]&amp;&amp;this.paramsSet[nsURI][name]){<span class="keywordflow">return</span> this.paramsSet[nsURI][name];}<span class="keywordflow">else</span>{<span class="keywordflow">return</span> null;}};XSLTProcessor.prototype.clearParameters=<span class="keyword">function</span>(){<span class="keywordflow">for</span>(var nsURI in this.paramsSet){<span class="keywordflow">for</span>(var name in this.paramsSet[nsURI]){<span class="keywordflow">if</span>(nsURI!=<span class="stringliteral">&quot;&quot;</span>){this.processor.addParameter(name,<span class="stringliteral">&quot;&quot;</span>,nsURI);}<span class="keywordflow">else</span>{this.processor.addParameter(name,<span class="stringliteral">&quot;&quot;</span>);}}}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;this.paramsSet=[];};}<span class="keywordflow">else</span>{<span class="keywordflow">if</span>(<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_CREATE_DOCUMENT){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.__handleLoad__=<span class="keyword">function</span>(oDoc){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.__setReadyState__(oDoc,4);};_sarissa_XMLDocument_onload=<span class="keyword">function</span>(){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.__handleLoad__(<span class="keyword">this</span>);};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.__setReadyState__=<span class="keyword">function</span>(oDoc,iReadyState){oDoc.readyState=iReadyState;oDoc.readystate=iReadyState;<span class="keywordflow">if</span>(oDoc.onreadystatechange!=null&amp;&amp;typeof oDoc.onreadystatechange==<span class="stringliteral">&quot;function&quot;</span>){oDoc.onreadystatechange();}};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument=<span class="keyword">function</span>(sUri,sName){var oDoc=document.implementation.createDocument(sUri?sUri:null,sName?sName:null,null);<span class="keywordflow">if</span>(!oDoc.onreadystatechange){oDoc.onreadystatechange=null;}</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordflow">if</span>(!oDoc.readyState){oDoc.readyState=0;}</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;oDoc.addEventListener(<span class="stringliteral">&quot;load&quot;</span>,_sarissa_XMLDocument_onload,<span class="keyword">false</span>);<span class="keywordflow">return</span> oDoc;};<span class="keywordflow">if</span>(window.XMLDocument){}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_HAS_DOM_FEATURE&amp;&amp;window.Document&amp;&amp;!Document.prototype.load&amp;&amp;document.implementation.hasFeature(<span class="stringliteral">&#39;LS&#39;</span>,<span class="stringliteral">&#39;3.0&#39;</span>)){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument=<span class="keyword">function</span>(sUri,sName){var oDoc=document.implementation.createDocument(sUri?sUri:null,sName?sName:null,null);<span class="keywordflow">return</span> oDoc;};}</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordflow">else</span>{<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument=<span class="keyword">function</span>(sUri,sName){var oDoc=document.implementation.createDocument(sUri?sUri:null,sName?sName:null,null);<span class="keywordflow">if</span>(oDoc&amp;&amp;(sUri||sName)&amp;&amp;!oDoc.documentElement){oDoc.appendChild(oDoc.createElementNS(sUri,sName));}</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keywordflow">return</span> oDoc;};}}}</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordflow">if</span>(!window.DOMParser){<span class="keywordflow">if</span>(<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_SAFARI){DOMParser=<span class="keyword">function</span>(){};DOMParser.prototype.parseFromString=<span class="keyword">function</span>(sXml,contentType){var xmlhttp=<span class="keyword">new</span> XMLHttpRequest();xmlhttp.open(<span class="stringliteral">&quot;GET&quot;</span>,<span class="stringliteral">&quot;data:text/xml;charset=utf-8,&quot;</span>+encodeURIComponent(sXml),<span class="keyword">false</span>);xmlhttp.send(null);<span class="keywordflow">return</span> xmlhttp.responseXML;};}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument&amp;&amp;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument()&amp;&amp;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument(null,<span class="stringliteral">&quot;bar&quot;</span>).xml){DOMParser=<span class="keyword">function</span>(){};DOMParser.prototype.parseFromString=<span class="keyword">function</span>(sXml,contentType){var doc=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument();doc.loadXML(sXml);<span class="keywordflow">return</span> doc;};}}</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordflow">if</span>((typeof(document.importNode)==<span class="stringliteral">&quot;undefined&quot;</span>)&amp;&amp;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_IE){<span class="keywordflow">try</span>{document.importNode=<span class="keyword">function</span>(oNode,bChildren){var tmp;<span class="keywordflow">if</span>(oNode.nodeName==<span class="stringliteral">&#39;#text&#39;</span>){<span class="keywordflow">return</span> document.createTextNode(oNode.data);}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordflow">else</span>{<span class="keywordflow">if</span>(oNode.nodeName==<span class="stringliteral">&quot;tbody&quot;</span>||oNode.nodeName==<span class="stringliteral">&quot;tr&quot;</span>){tmp=document.createElement(<span class="stringliteral">&quot;table&quot;</span>);}</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordflow">else</span> <span class="keywordflow">if</span>(oNode.nodeName==<span class="stringliteral">&quot;td&quot;</span>){tmp=document.createElement(<span class="stringliteral">&quot;tr&quot;</span>);}</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keywordflow">else</span> <span class="keywordflow">if</span>(oNode.nodeName==<span class="stringliteral">&quot;option&quot;</span>){tmp=document.createElement(<span class="stringliteral">&quot;select&quot;</span>);}</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordflow">else</span>{tmp=document.createElement(<span class="stringliteral">&quot;div&quot;</span>);}</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordflow">if</span>(bChildren){tmp.innerHTML=oNode.xml?oNode.xml:oNode.outerHTML;}<span class="keywordflow">else</span>{tmp.innerHTML=oNode.xml?oNode.cloneNode(<span class="keyword">false</span>).xml:oNode.cloneNode(<span class="keyword">false</span>).outerHTML;}</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keywordflow">return</span> tmp.getElementsByTagName(<span class="stringliteral">&quot;*&quot;</span>)[0];}};}<span class="keywordflow">catch</span>(e){}}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keywordflow">if</span>(!<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getParseErrorText){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getParseErrorText=<span class="keyword">function</span>(oDoc){var parseErrorText=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_OK;<span class="keywordflow">if</span>((!oDoc)||(!oDoc.documentElement)){parseErrorText=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_EMPTY;}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(oDoc.documentElement.tagName==<span class="stringliteral">&quot;parsererror&quot;</span>){parseErrorText=oDoc.documentElement.firstChild.data;parseErrorText+=<span class="stringliteral">&quot;\n&quot;</span>+oDoc.documentElement.firstChild.nextSibling.firstChild.data;}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(oDoc.getElementsByTagName(<span class="stringliteral">&quot;parsererror&quot;</span>).length&gt;0){var parsererror=oDoc.getElementsByTagName(<span class="stringliteral">&quot;parsererror&quot;</span>)[0];parseErrorText=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getText(parsererror,<span class="keyword">true</span>)+<span class="stringliteral">&quot;\n&quot;</span>;}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(oDoc.parseError&amp;&amp;oDoc.parseError.errorCode!=0){parseErrorText=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.PARSED_UNKNOWN_ERROR;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keywordflow">return</span> parseErrorText;};}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getText=<span class="keyword">function</span>(oNode,deep){var s=<span class="stringliteral">&quot;&quot;</span>;var nodes=oNode.childNodes;<span class="keywordflow">for</span>(var i=0;i&lt;nodes.length;i++){var node=nodes[i];var nodeType=node.nodeType;<span class="keywordflow">if</span>(nodeType==Node.TEXT_NODE||nodeType==Node.CDATA_SECTION_NODE){s+=node.data;}<span class="keywordflow">else</span> <span class="keywordflow">if</span>(deep===<span class="keyword">true</span>&amp;&amp;(nodeType==Node.ELEMENT_NODE||nodeType==Node.DOCUMENT_NODE||nodeType==Node.DOCUMENT_FRAGMENT_NODE)){s+=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getText(node,<span class="keyword">true</span>);}}</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a5437e7c6f60a48c98bf15e0d229810bf">   72</a></span>&#160;<span class="keywordflow">return</span> s;};<span class="keywordflow">if</span>(!window.XMLSerializer&amp;&amp;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument&amp;&amp;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.getDomDocument(<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;foo&quot;</span>,null).xml){XMLSerializer=<span class="keyword">function</span>(){};XMLSerializer.prototype.serializeToString=<span class="keyword">function</span>(oNode){<span class="keywordflow">return</span> oNode.xml;};}</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="code" href="sarissa_8js.html#add730dd8c534eb477c8f345d7847e9c1">   73</a></span>&#160;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.stripTags=<span class="keyword">function</span>(s){<span class="keywordflow">return</span> s?s.replace(/&lt;[^&gt;]+&gt;/g,<span class="stringliteral">&quot;&quot;</span>):s;};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.clearChildNodes=<span class="keyword">function</span>(oNode){<span class="keywordflow">while</span>(oNode.firstChild){oNode.removeChild(oNode.firstChild);}};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.copyChildNodes=<span class="keyword">function</span>(nodeFrom,nodeTo,bPreserveExisting){<span class="keywordflow">if</span>(<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>._SARISSA_IS_SAFARI&amp;&amp;nodeTo.nodeType==Node.DOCUMENT_NODE){nodeTo=nodeTo.documentElement;}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordflow">if</span>((!nodeFrom)||(!nodeTo)){<span class="keywordflow">throw</span><span class="stringliteral">&quot;Both source and destination nodes must be provided&quot;</span>;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordflow">if</span>(!bPreserveExisting){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.clearChildNodes(nodeTo);}</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="code" href="sarissa_8js.html#abc9f74fe2a050f535779b5468fd33278">   76</a></span>&#160;var ownerDoc=nodeTo.nodeType==Node.DOCUMENT_NODE?nodeTo:nodeTo.ownerDocument;var nodes=nodeFrom.childNodes;var i;<span class="keywordflow">if</span>(typeof(ownerDoc.importNode)!=<span class="stringliteral">&quot;undefined&quot;</span>){<span class="keywordflow">for</span>(i=0;i&lt;nodes.length;i++){nodeTo.appendChild(ownerDoc.importNode(nodes[i],<span class="keyword">true</span>));}}<span class="keywordflow">else</span>{<span class="keywordflow">for</span>(i=0;i&lt;nodes.length;i++){nodeTo.appendChild(nodes[i].cloneNode(<span class="keyword">true</span>));}}};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.moveChildNodes=<span class="keyword">function</span>(nodeFrom,nodeTo,bPreserveExisting){<span class="keywordflow">if</span>((!nodeFrom)||(!nodeTo)){<span class="keywordflow">throw</span><span class="stringliteral">&quot;Both source and destination nodes must be provided&quot;</span>;}</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordflow">if</span>(!bPreserveExisting){<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.clearChildNodes(nodeTo);}</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;var nodes=nodeFrom.childNodes;<span class="keywordflow">if</span>(nodeFrom.ownerDocument==nodeTo.ownerDocument){<span class="keywordflow">while</span>(nodeFrom.firstChild){nodeTo.appendChild(nodeFrom.firstChild);}}<span class="keywordflow">else</span>{var ownerDoc=nodeTo.nodeType==Node.DOCUMENT_NODE?nodeTo:nodeTo.ownerDocument;var i;<span class="keywordflow">if</span>(typeof(ownerDoc.importNode)!=<span class="stringliteral">&quot;undefined&quot;</span>){<span class="keywordflow">for</span>(i=0;i&lt;nodes.length;i++){nodeTo.appendChild(ownerDoc.importNode(nodes[i],<span class="keyword">true</span>));}}<span class="keywordflow">else</span>{<span class="keywordflow">for</span>(i=0;i&lt;nodes.length;i++){nodeTo.appendChild(nodes[i].cloneNode(<span class="keyword">true</span>));}}</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="code" href="sarissa_8js.html#af3e139b639b8f55e97231c127e6ee2af">   79</a></span>&#160;<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.clearChildNodes(nodeFrom);}};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.xmlize=<span class="keyword">function</span>(anyObject,objectName,indentSpace){indentSpace=indentSpace?indentSpace:<span class="stringliteral">&#39;&#39;</span>;var s=indentSpace+<span class="charliteral">&#39;&lt;&#39;</span>+objectName+<span class="charliteral">&#39;&gt;&#39;</span>;var isLeaf=<span class="keyword">false</span>;<span class="keywordflow">if</span>(!(anyObject instanceof Object)||anyObject instanceof Number||anyObject instanceof String||anyObject instanceof Boolean||anyObject instanceof Date){s+=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.escape(<span class="stringliteral">&quot;&quot;</span>+anyObject);isLeaf=<span class="keyword">true</span>;}<span class="keywordflow">else</span>{s+=<span class="stringliteral">&quot;\n&quot;</span>;var isArrayItem=anyObject instanceof Array;<span class="keywordflow">for</span>(var name in anyObject){s+=<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.xmlize(anyObject[name],(isArrayItem?<span class="stringliteral">&quot;array-item key=\&quot;&quot;</span>+name+<span class="stringliteral">&quot;\&quot;&quot;</span>:name),indentSpace+<span class="stringliteral">&quot;   &quot;</span>);}</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;s+=indentSpace;}</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a6e8f79e1d24ed44c5638bd451db68677">   81</a></span>&#160;<span class="keywordflow">return</span>(s+=(objectName.indexOf(<span class="charliteral">&#39; &#39;</span>)!=-1?<span class="stringliteral">&quot;&lt;/array-item&gt;\n&quot;</span>:<span class="stringliteral">&quot;&lt;/&quot;</span>+objectName+<span class="stringliteral">&quot;&gt;\n&quot;</span>));};<a class="code" href="sarissa_8js.html#a0306c2dabc5e18a7387a7ace6f1a9aa4">Sarissa</a>.escape=<span class="keyword">function</span>(sXml){<span class="keywordflow">return</span> sXml.replace(/&amp;/g,<span class="stringliteral">&quot;&amp;amp;&quot;</span>).replace(/&lt;/g,<span class="stringliteral">&quot;&amp;lt;&quot;</span>).replace(/&gt;/g,<span class="stringliteral">&quot;&amp;gt;&quot;</span>).replace(/<span class="stringliteral">&quot;/g,&quot;</span>&amp;quot;<span class="stringliteral">&quot;).replace(/&#39;/g,&quot;</span>&amp;apos;<span class="stringliteral">&quot;);};Sarissa.unescape=function(sXml){return sXml.replace(/&amp;apos;/g,&quot;</span><span class="stringliteral">&#39;&quot;).replace(/&amp;quot;/g,&quot;\&quot;&quot;).replace(/&amp;gt;/g,&quot;&gt;&quot;).replace(/&amp;lt;/g,&quot;&lt;&quot;).replace(/&amp;amp;/g,&quot;&amp;&quot;);};Sarissa.updateCursor=function(oTargetElement,sValue){if(oTargetElement&amp;&amp;oTargetElement.style&amp;&amp;oTargetElement.style.cursor!=undefined){oTargetElement.style.cursor=sValue;}};Sarissa.updateContentFromURI=function(sFromUrl,oTargetElement,xsltproc,callback,skipCache){try{Sarissa.updateCursor(oTargetElement,&quot;wait&quot;);var xmlhttp=new XMLHttpRequest();xmlhttp.open(&quot;GET&quot;,sFromUrl,true);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4){try{var oDomDoc=xmlhttp.responseXML;if(oDomDoc&amp;&amp;Sarissa.getParseErrorText(oDomDoc)==Sarissa.PARSED_OK){Sarissa.updateContentFromNode(xmlhttp.responseXML,oTargetElement,xsltproc);if(callback){callback(sFromUrl,oTargetElement);}}</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="stringliteral">else{throw Sarissa.getParseErrorText(oDomDoc);}}</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="stringliteral">catch(e){if(callback){callback(sFromUrl,oTargetElement,e);}</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral">else{throw e;}}}};if(skipCache){var oldage=&quot;Sat, 1 Jan 2000 00:00:00 GMT&quot;;xmlhttp.setRequestHeader(&quot;If-Modified-Since&quot;,oldage);}</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="stringliteral">xmlhttp.send(&quot;&quot;);}</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral">catch(e){Sarissa.updateCursor(oTargetElement,&quot;auto&quot;);if(callback){callback(sFromUrl,oTargetElement,e);}</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a707d77312a3af6e10ffb0312aa258fd5">   87</a></span>&#160;<span class="stringliteral">else{throw e;}}};Sarissa.updateContentFromNode=function(oNode,oTargetElement,xsltproc){try{Sarissa.updateCursor(oTargetElement,&quot;wait&quot;);Sarissa.clearChildNodes(oTargetElement);var ownerDoc=oNode.nodeType==Node.DOCUMENT_NODE?oNode:oNode.ownerDocument;if(ownerDoc.parseError&amp;&amp;ownerDoc.parseError.errorCode!=0){var pre=document.createElement(&quot;pre&quot;);pre.appendChild(document.createTextNode(Sarissa.getParseErrorText(ownerDoc)));oTargetElement.appendChild(pre);}</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">else{if(xsltproc){oNode=xsltproc.transformToDocument(oNode);}</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">if(oTargetElement.tagName.toLowerCase()==&quot;textarea&quot;||oTargetElement.tagName.toLowerCase()==&quot;input&quot;){oTargetElement.value=new XMLSerializer().serializeToString(oNode);}</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral">else{try{oTargetElement.appendChild(oTargetElement.ownerDocument.importNode(oNode,true));}</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">catch(e){oTargetElement.innerHTML=new XMLSerializer().serializeToString(oNode);}}}}</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral">catch(e){throw e;}</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="sarissa_8js.html#abb75bbcc921d4346b62023f6a6c9d5b5">   93</a></span>&#160;<span class="stringliteral">finally{Sarissa.updateCursor(oTargetElement,&quot;auto&quot;);}};Sarissa.formToQueryString=function(oForm){var qs=&quot;&quot;;for(var i=0;i&lt;oForm.elements.length;i++){var oField=oForm.elements[i];var sFieldName=oField.getAttribute(&quot;name&quot;)?oField.getAttribute(&quot;name&quot;):oField.getAttribute(&quot;id&quot;);if(sFieldName&amp;&amp;((!oField.disabled)||oField.type==&quot;hidden&quot;)){switch(oField.type){case&quot;hidden&quot;:case&quot;text&quot;:case&quot;textarea&quot;:case&quot;password&quot;:qs+=sFieldName+&quot;=&quot;+encodeURIComponent(oField.value)+&quot;&amp;&quot;;break;case&quot;select-one&quot;:qs+=sFieldName+&quot;=&quot;+encodeURIComponent(oField.options[oField.selectedIndex].value)+&quot;&amp;&quot;;break;case&quot;select-multiple&quot;:for(var j=0;j&lt;oField.length;j++){var optElem=oField.options[j];if(optElem.selected===true){qs+=sFieldName+&quot;[]&quot;+&quot;=&quot;+encodeURIComponent(optElem.value)+&quot;&amp;&quot;;}}</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">break;case&quot;checkbox&quot;:case&quot;radio&quot;:if(oField.checked){qs+=sFieldName+&quot;=&quot;+encodeURIComponent(oField.value)+&quot;&amp;&quot;;}</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">break;}}}</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="code" href="sarissa_8js.html#ac18ef95dafb14bcb3b888c926ece4c9f">   96</a></span>&#160;<span class="stringliteral">return qs.substr(0,qs.length-1);};Sarissa.updateContentFromForm=function(oForm,oTargetElement,xsltproc,callback){try{Sarissa.updateCursor(oTargetElement,&quot;wait&quot;);var params=Sarissa.formToQueryString(oForm)+&quot;&amp;&quot;+Sarissa.REMOTE_CALL_FLAG+&quot;=true&quot;;var xmlhttp=new XMLHttpRequest();var bUseGet=oForm.getAttribute(&quot;method&quot;)&amp;&amp;oForm.getAttribute(&quot;method&quot;).toLowerCase()==&quot;get&quot;;if(bUseGet){xmlhttp.open(&quot;GET&quot;,oForm.getAttribute(&quot;action&quot;)+&quot;?&quot;+params,true);}</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">else{xmlhttp.open(&#39;</span><a class="code" href="supported__data__types_8php.html#a266e25cc4bc4d1fc753aede118504cf9">POST</a><span class="stringliteral">&#39;,oForm.getAttribute(&quot;action&quot;),true);xmlhttp.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);xmlhttp.setRequestHeader(&quot;Content-length&quot;,params.length);xmlhttp.setRequestHeader(&quot;Connection&quot;,&quot;close&quot;);}</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">xmlhttp.onreadystatechange=function(){try{if(xmlhttp.readyState==4){var oDomDoc=xmlhttp.responseXML;if(oDomDoc&amp;&amp;Sarissa.getParseErrorText(oDomDoc)==Sarissa.PARSED_OK){Sarissa.updateContentFromNode(xmlhttp.responseXML,oTargetElement,xsltproc);if(callback){callback(oForm,oTargetElement);}}</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">else{throw Sarissa.getParseErrorText(oDomDoc);}}}</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">catch(e){if(callback){callback(oForm,oTargetElement,e);}</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">else{throw e;}}};xmlhttp.send(bUseGet?&quot;&quot;:params);}</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral">catch(e){Sarissa.updateCursor(oTargetElement,&quot;auto&quot;);if(callback){callback(oForm,oTargetElement,e);}</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">else{throw e;}}</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a018c68d4029d884800effe825b7ab22f">  104</a></span>&#160;<span class="stringliteral">return false;};Sarissa.FUNCTION_NAME_REGEXP=new RegExp(&quot;&quot;);Sarissa.getFunctionName=function(oFunc,bForce){var name;if(!name){if(bForce){name=&quot;SarissaAnonymous&quot;+Sarissa._getUniqueSuffix();window[name]=oFunc;}</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="stringliteral">else{name=null;}}</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="stringliteral">if(name){window[name]=oFunc;}</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="code" href="sarissa_8js.html#a88a55e4dd3a6e737a8e74636adb39976">  107</a></span>&#160;<span class="stringliteral">return name;};Sarissa.setRemoteJsonCallback=function(url,callback,callbackParam){if(!callbackParam){callbackParam=&quot;callback&quot;;}</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral">var callbackFunctionName=Sarissa.getFunctionName(callback,true);var id=&quot;sarissa_json_script_id_&quot;+Sarissa._getUniqueSuffix();var oHead=document.getElementsByTagName(&quot;head&quot;)[0];var scriptTag=document.createElement(&#39;</span>script<span class="stringliteral">&#39;);scriptTag.type=&#39;</span>text/javascript<span class="stringliteral">&#39;;scriptTag.id=id;scriptTag.onload=function(){};if(url.indexOf(&quot;?&quot;)!=-1){url+=(&quot;&amp;&quot;+callbackParam+&quot;=&quot;+callbackFunctionName);}</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="stringliteral">else{url+=(&quot;?&quot;+callbackParam+&quot;=&quot;+callbackFunctionName);}</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="stringliteral">scriptTag.src=url;oHead.appendChild(scriptTag);return id;};</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_93501a11e921083efbd154e0cdff5f10.html">packages</a></li><li class="navelem"><a class="el" href="dir_6e11b47f71b207b27145207ea75fef9e.html">gui</a></li><li class="navelem"><a class="el" href="dir_22da140b0ceba9af8df63b75c08d8cba.html">packages</a></li><li class="navelem"><a class="el" href="dir_2f6b4165041e67b8366be7fbb419f461.html">jstree</a></li><li class="navelem"><a class="el" href="dir_52917e5831422407e6cd790641f688ff.html">include</a></li><li class="navelem"><a class="el" href="dir_f383e4d83ce1ae51201b338b44886535.html">js</a></li><li class="navelem"><a class="el" href="dir_89c83c717d50b449a1241ae547ed39dd.html">lib</a></li><li class="navelem"><a class="el" href="sarissa_8js.html">sarissa.js</a></li>
    <li class="footer">Generated on Fri Sep 28 2012 17:16:51 for ultimix by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
