<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ultimix: OLERead Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a>  </div>
  <div class="headertitle">
<h1>OLERead Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="OLERead" -->
<p><a href="class_o_l_e_read-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_l_e_read.html#a40b7f7742b479ed7745b180ab50f81c7">OLERead</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_l_e_read.html#af668c1fdf25aad3b8a80440d28fa8c38">read</a> ($sFileName)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_l_e_read.html#aaf1f2e28944f22867ce36c7a8803e520">__readData</a> ($bl)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_l_e_read.html#aae665b283e5467d1231371ebc0d6ea69">__readPropertySets</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_l_e_read.html#a37f529c2421df67f34717d887855b76c">getWorkBook</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_o_l_e_read.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a> = ''</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="excel__reader2_8php_source.html#l00095">95</a> of file <a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aaf1f2e28944f22867ce36c7a8803e520"></a><!-- doxytag: member="OLERead::__readData" ref="aaf1f2e28944f22867ce36c7a8803e520" args="($bl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__readData </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>bl</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="excel__reader2_8php_source.html#l00187">187</a> of file <a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a>.</p>

<p><div class="fragment"><pre class="fragment">                                     {
                  $block = $bl;
                  $pos = 0;
                  <a class="code" href="class_o_l_e_read.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a> = <span class="stringliteral">&#39;&#39;</span>;
                  <span class="keywordflow">while</span> ($block != -2)  {
                        $pos = ($block + 1) * <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a>;
                        <a class="code" href="class_o_l_e_read.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a> = <a class="code" href="class_o_l_e_read.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>.substr($this-&gt;data, $pos, <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a>);
                        $block = $this-&gt;bigBlockChain[$block];
                  }
                  <span class="keywordflow">return</span> <a class="code" href="class_o_l_e_read.html#a6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>;
             }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aae665b283e5467d1231371ebc0d6ea69"></a><!-- doxytag: member="OLERead::__readPropertySets" ref="aae665b283e5467d1231371ebc0d6ea69" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__readPropertySets </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="excel__reader2_8php_source.html#l00199">199</a> of file <a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a>.</p>

<p><div class="fragment"><pre class="fragment">                                         {
                  $offset = 0;
                  <span class="keywordflow">while</span> ($offset &lt; strlen($this-&gt;entry)) {
                        $d = substr($this-&gt;entry, $offset, <a class="code" href="excel__reader2_8php.html#a06d231358f27e720cb5a192f036859ff">PROPERTY_STORAGE_BLOCK_SIZE</a>);
                        $nameSize = ord($d[<a class="code" href="excel__reader2_8php.html#acab99fb04944e6320a6ad019f7aaf92e">SIZE_OF_NAME_POS</a>]) | (ord($d[<a class="code" href="excel__reader2_8php.html#acab99fb04944e6320a6ad019f7aaf92e">SIZE_OF_NAME_POS</a>+1]) &lt;&lt; 8);
                        $type = ord($d[<a class="code" href="excel__reader2_8php.html#ac408eba7bb1d15f81dead5670f858bdd">TYPE_POS</a>]);
                        $startBlock = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($d, <a class="code" href="excel__reader2_8php.html#a9adf310156f95c2a2936ac31f83a643a">START_BLOCK_POS</a>);
                        $size = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($d, <a class="code" href="excel__reader2_8php.html#acea12658170a78ccb85764a3098abb4c">SIZE_POS</a>);
                        $name = <span class="stringliteral">&#39;&#39;</span>;
                        <span class="keywordflow">for</span> ($i = 0; $i &lt; $nameSize ; $i++) {
                              $name .= $d[$i];
                        }
                        $name = str_replace(<span class="stringliteral">&quot;\x00&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, $name);
                        $this-&gt;props[] = array (
                              <span class="stringliteral">&#39;name&#39;</span> =&gt; $name,
                              <span class="stringliteral">&#39;type&#39;</span> =&gt; $type,
                              <span class="stringliteral">&#39;startBlock&#39;</span> =&gt; $startBlock,
                              <span class="stringliteral">&#39;size&#39;</span> =&gt; $size);
                        <span class="keywordflow">if</span> ((strtolower($name) == <span class="stringliteral">&quot;workbook&quot;</span>) || ( strtolower($name) == <span class="stringliteral">&quot;book&quot;</span>)) {
                              $this-&gt;wrkbook = count($this-&gt;props) - 1;
                        }
                        <span class="keywordflow">if</span> ($name == <span class="stringliteral">&quot;Root Entry&quot;</span>) {
                              $this-&gt;rootentry = count($this-&gt;props) - 1;
                        }
                        $offset += PROPERTY_STORAGE_BLOCK_SIZE;
                  }

            }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37f529c2421df67f34717d887855b76c"></a><!-- doxytag: member="OLERead::getWorkBook" ref="a37f529c2421df67f34717d887855b76c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getWorkBook </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="excel__reader2_8php_source.html#l00229">229</a> of file <a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a>.</p>

<p><div class="fragment"><pre class="fragment">                                  {
                  <span class="keywordflow">if</span> ($this-&gt;props[$this-&gt;wrkbook][<span class="stringliteral">&#39;size&#39;</span>] &lt; <a class="code" href="excel__reader2_8php.html#a6d6c72928962630d37d6b12b8d9fcabb">SMALL_BLOCK_THRESHOLD</a>){
                        $rootdata = $this-&gt;<a class="code" href="class_o_l_e_read.html#aaf1f2e28944f22867ce36c7a8803e520">__readData</a>($this-&gt;props[$this-&gt;rootentry][<span class="stringliteral">&#39;startBlock&#39;</span>]);
                        $streamData = <span class="stringliteral">&#39;&#39;</span>;
                        $block = $this-&gt;props[$this-&gt;wrkbook][<span class="stringliteral">&#39;startBlock&#39;</span>];
                        $pos = 0;
                        <span class="keywordflow">while</span> ($block != -2) {
                                $pos = $block * SMALL_BLOCK_SIZE;
                                $streamData .= substr($rootdata, $pos, SMALL_BLOCK_SIZE);
                                $block = $this-&gt;smallBlockChain[$block];
                        }
                        <span class="keywordflow">return</span> $streamData;
                  }<span class="keywordflow">else</span>{
                        $numBlocks = $this-&gt;props[$this-&gt;wrkbook][<span class="stringliteral">&#39;size&#39;</span>] / BIG_BLOCK_SIZE;
                        <span class="keywordflow">if</span> ($this-&gt;props[$this-&gt;wrkbook][<span class="stringliteral">&#39;size&#39;</span>] % <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a> != 0) {
                              $numBlocks++;
                        }

                        <span class="keywordflow">if</span> ($numBlocks == 0) <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;
                        $streamData = <span class="stringliteral">&#39;&#39;</span>;
                        $block = $this-&gt;props[$this-&gt;wrkbook][<span class="stringliteral">&#39;startBlock&#39;</span>];
                        $pos = 0;
                        <span class="keywordflow">while</span> ($block != -2) {
                          $pos = ($block + 1) * <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a>;
                          $streamData .= substr($this-&gt;data, $pos, <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a>);
                          $block = $this-&gt;bigBlockChain[$block];
                        }
                        <span class="keywordflow">return</span> $streamData;
                  }
            }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a40b7f7742b479ed7745b180ab50f81c7"></a><!-- doxytag: member="OLERead::OLERead" ref="a40b7f7742b479ed7745b180ab50f81c7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_o_l_e_read.html">OLERead</a> </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="excel__reader2_8php_source.html#l00097">97</a> of file <a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a>.</p>

<p><div class="fragment"><pre class="fragment">{     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af668c1fdf25aad3b8a80440d28fa8c38"></a><!-- doxytag: member="OLERead::read" ref="af668c1fdf25aad3b8a80440d28fa8c38" args="($sFileName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">read </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>sFileName</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="excel__reader2_8php_source.html#l00099">99</a> of file <a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a>.</p>

<p><div class="fragment"><pre class="fragment">                                     {
                  <span class="comment">// check if file exist and is readable (Darko Miljanovic)</span>
                  <span class="keywordflow">if</span>(!is_readable($sFileName)) {
                        $this-&gt;error = 1;
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                  }
                  $this-&gt;data = @file_get_contents($sFileName);
                  <span class="keywordflow">if</span> (!$this-&gt;data) {
                        $this-&gt;error = 1;
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                  }
                  <span class="keywordflow">if</span> (substr($this-&gt;data, 0, 8) != <a class="code" href="excel__reader2_8php.html#aa8016cb7a4ba490386fdff9633473ce6">IDENTIFIER_OLE</a>) {
                        $this-&gt;error = 1;
                        <span class="keywordflow">return</span> <span class="keyword">false</span>;
                  }
                  $this-&gt;numBigBlockDepotBlocks = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, <a class="code" href="excel__reader2_8php.html#a4468f561cb20953cb608537cdd92c694">NUM_BIG_BLOCK_DEPOT_BLOCKS_POS</a>);
                  $this-&gt;sbdStartBlock = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, <a class="code" href="excel__reader2_8php.html#a6ed4e1850c58b4efa1fc2cb84c0f6935">SMALL_BLOCK_DEPOT_BLOCK_POS</a>);
                  $this-&gt;rootStartBlock = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, <a class="code" href="excel__reader2_8php.html#aa575971a0e64eb45f8cbb0aba3c6ff6e">ROOT_START_BLOCK_POS</a>);
                  $this-&gt;extensionBlock = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, <a class="code" href="excel__reader2_8php.html#a400c3de6d4fc802d323942d97e09521f">EXTENSION_BLOCK_POS</a>);
                  $this-&gt;numExtensionBlocks = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, <a class="code" href="excel__reader2_8php.html#aaa68369f0abfaa874cf335affb0e13b3">NUM_EXTENSION_BLOCK_POS</a>);

                  $bigBlockDepotBlocks = array();
                  $pos = BIG_BLOCK_DEPOT_BLOCKS_POS;
                  $bbdBlocks = $this-&gt;numBigBlockDepotBlocks;
                  <span class="keywordflow">if</span> ($this-&gt;numExtensionBlocks != 0) {
                        $bbdBlocks = (<a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a> - BIG_BLOCK_DEPOT_BLOCKS_POS)/4;
                  }

                  <span class="keywordflow">for</span> ($i = 0; $i &lt; $bbdBlocks; $i++) {
                        $bigBlockDepotBlocks[$i] = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, $pos);
                        $pos += 4;
                  }


                  <span class="keywordflow">for</span> ($j = 0; $j &lt; $this-&gt;numExtensionBlocks; $j++) {
                        $pos = ($this-&gt;extensionBlock + 1) * <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a>;
                        $blocksToRead = min($this-&gt;numBigBlockDepotBlocks - $bbdBlocks, <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a> / 4 - 1);

                        <span class="keywordflow">for</span> ($i = $bbdBlocks; $i &lt; $bbdBlocks + $blocksToRead; $i++) {
                              $bigBlockDepotBlocks[$i] = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, $pos);
                              $pos += 4;
                        }

                        $bbdBlocks += $blocksToRead;
                        <span class="keywordflow">if</span> ($bbdBlocks &lt; $this-&gt;numBigBlockDepotBlocks) {
                              $this-&gt;extensionBlock = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, $pos);
                        }
                  }

                  <span class="comment">// readBigBlockDepot</span>
                  $pos = 0;
                  $index = 0;
                  $this-&gt;bigBlockChain = array();

                  <span class="keywordflow">for</span> ($i = 0; $i &lt; $this-&gt;numBigBlockDepotBlocks; $i++) {
                        $pos = ($bigBlockDepotBlocks[$i] + 1) * <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a>;
                        <span class="comment">//echo &quot;pos = $pos&quot;;</span>
                        <span class="keywordflow">for</span> ($j = 0 ; $j &lt; <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a> / 4; $j++) {
                              $this-&gt;bigBlockChain[$index] = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, $pos);
                              $pos += 4 ;
                              $index++;
                        }
                  }

                  <span class="comment">// readSmallBlockDepot();</span>
                  $pos = 0;
                  $index = 0;
                  $sbdBlock = $this-&gt;sbdStartBlock;
                  $this-&gt;smallBlockChain = array();

                  <span class="keywordflow">while</span> ($sbdBlock != -2) {
                    $pos = ($sbdBlock + 1) * <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a>;
                    <span class="keywordflow">for</span> ($j = 0; $j &lt; <a class="code" href="excel__reader2_8php.html#ad60fde6ab1c85051fdaa8209a1056e2b">BIG_BLOCK_SIZE</a> / 4; $j++) {
                        $this-&gt;smallBlockChain[$index] = <a class="code" href="excel__reader2_8php.html#a75218326fba8e85aa967eeb87e24baee">GetInt4d</a>($this-&gt;data, $pos);
                        $pos += 4;
                        $index++;
                    }
                    $sbdBlock = $this-&gt;bigBlockChain[$sbdBlock];
                  }


                  <span class="comment">// readData(rootStartBlock)</span>
                  $block = $this-&gt;rootStartBlock;
                  $pos = 0;
                  $this-&gt;entry = $this-&gt;<a class="code" href="class_o_l_e_read.html#aaf1f2e28944f22867ce36c7a8803e520">__readData</a>($block);
                  $this-&gt;<a class="code" href="class_o_l_e_read.html#aae665b283e5467d1231371ebc0d6ea69">__readPropertySets</a>();
            }
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a6efc15b5a2314dd4b5aaa556a375c6d6"></a><!-- doxytag: member="OLERead::$data" ref="a6efc15b5a2314dd4b5aaa556a375c6d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$data = ''</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="excel__reader2_8php_source.html#l00096">96</a> of file <a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>G:/projects/webdev/wwwroot/ultimix/packages/file_formats/packages/excel_reader/include/php/<a class="el" href="excel__reader2_8php_source.html">excel_reader2.php</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 3 2011 14:50:24 for ultimix by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
