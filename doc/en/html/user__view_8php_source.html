<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ultimix: G:/projects/webdev/wwwroot/ultimix/packages/user/packages/user_view/user_view.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>G:/projects/webdev/wwwroot/ultimix/packages/user/packages/user_view/user_view.php</h1>  </div>
</div>
<div class="contents">
<a href="user__view_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003       <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment">      *     This source code is a part of the Ultimix Project. </span>
<a name="l00005"></a>00005 <span class="comment">      *     It is distributed under BSD license. All other third side source code (like tinyMCE) is distributed under </span>
<a name="l00006"></a>00006 <span class="comment">      *     it&#39;s own license wich could be found from the corresponding files or sources. </span>
<a name="l00007"></a>00007 <span class="comment">      *     This source code is provided &quot;as is&quot; without any warranties or garanties.</span>
<a name="l00008"></a>00008 <span class="comment">      *</span>
<a name="l00009"></a>00009 <span class="comment">      *     Have a nice day!</span>
<a name="l00010"></a>00010 <span class="comment">      *</span>
<a name="l00011"></a>00011 <span class="comment">      *     @url http://ultimix.sorceforge.net</span>
<a name="l00012"></a>00012 <span class="comment">      *</span>
<a name="l00013"></a>00013 <span class="comment">      *     @author Alexey &quot;gdever&quot; Dodonov</span>
<a name="l00014"></a>00014 <span class="comment">      */</span>
<a name="l00015"></a>00015       
<a name="l00026"></a><a class="code" href="classuser__view__1__0__0.html">00026</a>       <span class="keyword">class </span><a class="code" href="classuser__view__1__0__0.html">user_view_1_0_0</a>{
<a name="l00027"></a>00027       
<a name="l00038"></a><a class="code" href="classuser__view__1__0__0.html#a42734c34e5429a8ec8d5dc3ff7331492">00038</a>             var                           <a class="code" href="classuser__view__1__0__0.html#a42734c34e5429a8ec8d5dc3ff7331492">$BlockSettings</a> = <span class="keyword">false</span>;
<a name="l00039"></a><a class="code" href="classuser__view__1__0__0.html#a1b21a3420462aafbfb9e6420c224452d">00039</a>             var                           <a class="code" href="classuser__view__1__0__0.html#a1b21a3420462aafbfb9e6420c224452d">$CachedMultyFS</a> = <span class="keyword">false</span>;
<a name="l00040"></a><a class="code" href="classuser__view__1__0__0.html#ace87db894bcbf9c284ce03c825dda2a5">00040</a>             var                           <a class="code" href="classuser__view__1__0__0.html#ace87db894bcbf9c284ce03c825dda2a5">$GUI</a> = <span class="keyword">false</span>;
<a name="l00041"></a><a class="code" href="classuser__view__1__0__0.html#abb2043be9a91c077dee65db7c8ab3460">00041</a>             var                           <a class="code" href="classuser__view__1__0__0.html#abb2043be9a91c077dee65db7c8ab3460">$PermitAlgorithms</a> = <span class="keyword">false</span>;
<a name="l00042"></a><a class="code" href="classuser__view__1__0__0.html#aaae5f70ebc2b60f22e8159944cd2d518">00042</a>             var                           <a class="code" href="classuser__view__1__0__0.html#aaae5f70ebc2b60f22e8159944cd2d518">$Security</a> = <span class="keyword">false</span>;
<a name="l00043"></a><a class="code" href="classuser__view__1__0__0.html#a541f49d5b9cf7bae2f91f639abcf3458">00043</a>             var                           <a class="code" href="classuser__view__1__0__0.html#a541f49d5b9cf7bae2f91f639abcf3458">$String</a> = <span class="keyword">false</span>;
<a name="l00044"></a><a class="code" href="classuser__view__1__0__0.html#a51389eaa5dbc754ca5351c42b5adbf41">00044</a>             var                           <a class="code" href="classuser__view__1__0__0.html#a51389eaa5dbc754ca5351c42b5adbf41">$UserAccess</a> = <span class="keyword">false</span>;
<a name="l00045"></a><a class="code" href="classuser__view__1__0__0.html#ad3377fd103ea8c6d35b0ee60e4e9c46d">00045</a>             var                           <a class="code" href="classuser__view__1__0__0.html#ad3377fd103ea8c6d35b0ee60e4e9c46d">$UserAlgorithms</a> = <span class="keyword">false</span>;
<a name="l00046"></a>00046       
<a name="l00057"></a><a class="code" href="classuser__view__1__0__0.html#a8a55ddd2b83051d9d86510dcd04f9f4c">00057</a>             var                           <a class="code" href="classuser__view__1__0__0.html#a8a55ddd2b83051d9d86510dcd04f9f4c">$Output</a> = <span class="keyword">false</span>;
<a name="l00058"></a>00058       
<a name="l00069"></a><a class="code" href="classuser__view__1__0__0.html#a22dca00eecbe474738a69d0fee4ce384">00069</a>             var                           <a class="code" href="classuser__view__1__0__0.html#a22dca00eecbe474738a69d0fee4ce384">$EnableRegistration</a> = 1;
<a name="l00070"></a>00070       
<a name="l00081"></a><a class="code" href="classuser__view__1__0__0.html#a095c5d389db211932136b53f25f39685">00081</a>             function                <a class="code" href="classuser__view__1__0__0.html#a095c5d389db211932136b53f25f39685">__construct</a>()
<a name="l00082"></a>00082             {
<a name="l00083"></a>00083                   <span class="keywordflow">try</span>
<a name="l00084"></a>00084                   {
<a name="l00085"></a>00085                         $this-&gt;BlockSettings = <a class="code" href="core__public__api_8php.html#a7dbfff8b452767e03ec52155dff6bdd3">get_package_object</a>( <span class="stringliteral">&#39;settings::settings&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00086"></a>00086                         $this-&gt;CachedMultyFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00087"></a>00087                         $this-&gt;GUI = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;gui&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00088"></a>00088                         $this-&gt;PermitAlgorithms = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;permit::permit_algorithms&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00089"></a>00089                         $this-&gt;Security = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;security&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00090"></a>00090                         $this-&gt;String = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;string&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00091"></a>00091                         $this-&gt;UserAccess = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;user::user_access&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00092"></a>00092                         $this-&gt;UserAlgorithms = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;user::user_algorithms&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00093"></a>00093                         
<a name="l00094"></a>00094                         $Settings = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;settings::settings&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00095"></a>00095                         $Settings-&gt;load_package_settings( <span class="stringliteral">&#39;user::user_controller&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , <span class="stringliteral">&#39;cf_user&#39;</span> );
<a name="l00096"></a>00096                         $this-&gt;EnableRegistration = intval( $Settings-&gt;get_setting( <span class="stringliteral">&#39;enable_registration&#39;</span> , 1 ) );
<a name="l00097"></a>00097                         $this-&gt;RegistrationConfirm = intval( $Settings-&gt;get_setting( <span class="stringliteral">&#39;registration_confirm&#39;</span> , 1 ) );
<a name="l00098"></a>00098                   }
<a name="l00099"></a>00099                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00100"></a>00100                   {
<a name="l00101"></a>00101                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00102"></a>00102                   }
<a name="l00103"></a>00103             }
<a name="l00104"></a>00104       
<a name="l00123"></a><a class="code" href="classuser__view__1__0__0.html#aa7a7e021f2db6a6fc6c2fd16be9330f1">00123</a>             function                <a class="code" href="classuser__view__1__0__0.html#aa7a7e021f2db6a6fc6c2fd16be9330f1">pre_generation</a>( $Options )
<a name="l00124"></a>00124             {
<a name="l00125"></a>00125                   <span class="keywordflow">try</span>
<a name="l00126"></a>00126                   {
<a name="l00127"></a>00127                         $PageComposerUtilities = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;page::page_composer_utilities&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00128"></a>00128                         $PackagePath = <a class="code" href="core_8php.html#a5723fd5d1f06ff63181f91d948316d87">_get_package_relative_path_ex</a>( <span class="stringliteral">&#39;user::user_view&#39;</span> , <span class="stringliteral">&#39;1.0.0::1.0.0&#39;</span> );
<a name="l00129"></a>00129                         $PageComposerUtilities-&gt;add_javascript( <span class="stringliteral">&quot;{http_host}/$PackagePath/include/js/user_view.js&quot;</span> );
<a name="l00130"></a>00130                   }
<a name="l00131"></a>00131                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00132"></a>00132                   {
<a name="l00133"></a>00133                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00134"></a>00134                   }
<a name="l00135"></a>00135             }
<a name="l00136"></a>00136             
<a name="l00155"></a><a class="code" href="classuser__view__1__0__0.html#adfb7b4b454b3dd4d2a1eab1ecbde04d7">00155</a>             function                <a class="code" href="classuser__view__1__0__0.html#adfb7b4b454b3dd4d2a1eab1ecbde04d7">login_form</a>( $Options )
<a name="l00156"></a>00156             {
<a name="l00157"></a>00157                   <span class="keywordflow">try</span>
<a name="l00158"></a>00158                   {
<a name="l00159"></a>00159                         $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00160"></a>00160                         $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;login_form.tpl&#39;</span> );
<a name="l00161"></a>00161                         
<a name="l00162"></a>00162                         <span class="keywordflow">if</span>( $this-&gt;EnableRegistration === 1 )
<a name="l00163"></a>00163                         {
<a name="l00164"></a>00164                               $this-&gt;Output = str_replace( 
<a name="l00165"></a>00165                                     <span class="stringliteral">&#39;{registration_link}&#39;</span> , <span class="stringliteral">&#39;{href:page=registration.html;text=registration}&#39;</span> , $this-&gt;Output
<a name="l00166"></a>00166                               );
<a name="l00167"></a>00167                         }
<a name="l00168"></a>00168                   }
<a name="l00169"></a>00169                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00170"></a>00170                   {
<a name="l00171"></a>00171                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00172"></a>00172                   }
<a name="l00173"></a>00173             }
<a name="l00174"></a>00174             
<a name="l00193"></a><a class="code" href="classuser__view__1__0__0.html#a289726c9462af26eb889780e2ab1a7dc">00193</a>             function                <a class="code" href="classuser__view__1__0__0.html#a289726c9462af26eb889780e2ab1a7dc">logout_form</a>( $Options )
<a name="l00194"></a>00194             {
<a name="l00195"></a>00195                   <span class="keywordflow">try</span>
<a name="l00196"></a>00196                   {
<a name="l00197"></a>00197                         $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00198"></a>00198                         $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;logout_form.tpl&#39;</span> );
<a name="l00199"></a>00199                   }
<a name="l00200"></a>00200                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00201"></a>00201                   {
<a name="l00202"></a>00202                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00203"></a>00203                   }
<a name="l00204"></a>00204             }
<a name="l00205"></a>00205             
<a name="l00224"></a><a class="code" href="classuser__view__1__0__0.html#a874e85ccc57eb1695bbe2ac9e326ab60">00224</a>             function                <a class="code" href="classuser__view__1__0__0.html#a874e85ccc57eb1695bbe2ac9e326ab60">switch_user</a>( $Options )
<a name="l00225"></a>00225             {
<a name="l00226"></a>00226                   <span class="keywordflow">try</span>
<a name="l00227"></a>00227                   {
<a name="l00228"></a>00228                         $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00229"></a>00229                         $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;switch_user_form.tpl&#39;</span> );
<a name="l00230"></a>00230                   }
<a name="l00231"></a>00231                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00232"></a>00232                   {
<a name="l00233"></a>00233                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00234"></a>00234                   }
<a name="l00235"></a>00235             }
<a name="l00236"></a>00236       
<a name="l00255"></a><a class="code" href="classuser__view__1__0__0.html#a12882c9f67d1ae6a658aeaae01fd4172">00255</a>             function                <a class="code" href="classuser__view__1__0__0.html#a12882c9f67d1ae6a658aeaae01fd4172">show_registration_form</a>( $Options )
<a name="l00256"></a>00256             {
<a name="l00257"></a>00257                   <span class="keywordflow">try</span>
<a name="l00258"></a>00258                   {
<a name="l00259"></a>00259                         <span class="keywordflow">if</span>( $this-&gt;EnableRegistration === 1 || 
<a name="l00260"></a>00260                               $this-&gt;PermitAlgorithms-&gt;object_has_permit( <span class="keyword">false</span> , <span class="stringliteral">&#39;user&#39;</span> , <span class="stringliteral">&#39;user_manager&#39;</span> ) )
<a name="l00261"></a>00261                         {
<a name="l00262"></a>00262                               $UserController = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;user::user_controller&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00263"></a>00263                               <a class="code" href="classuser__view__1__0__0.html#aaae5f70ebc2b60f22e8159944cd2d518">$Security</a> = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;security&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00264"></a>00264                               $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00265"></a>00265                               <span class="keywordflow">if</span>( <a class="code" href="classuser__view__1__0__0.html#aaae5f70ebc2b60f22e8159944cd2d518">$Security</a>-&gt;get_gp( <span class="stringliteral">&#39;user_action&#39;</span> ) &amp;&amp; $UserController-&gt;RegistrationWasPassed )
<a name="l00266"></a>00266                               {
<a name="l00267"></a>00267                                     <span class="keywordflow">if</span>( $UserController-&gt;RegistrationConfirm )
<a name="l00268"></a>00268                                     {
<a name="l00269"></a>00269                                           $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;confirm_registration.tpl&#39;</span> );
<a name="l00270"></a>00270                                     }
<a name="l00271"></a>00271                                     <span class="keywordflow">else</span>
<a name="l00272"></a>00272                                     {
<a name="l00273"></a>00273                                           $this-&gt;Output = <span class="stringliteral">&#39;{lang:registration_complete}&#39;</span>;
<a name="l00274"></a>00274                                     }
<a name="l00275"></a>00275                               }
<a name="l00276"></a>00276                               <span class="keywordflow">else</span>
<a name="l00277"></a>00277                               {                             
<a name="l00278"></a>00278                                     $Template = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;registration_form.tpl&#39;</span> );
<a name="l00279"></a>00279                                     $Template = $this-&gt;String-&gt;print_record( $Template , $_POST );
<a name="l00280"></a>00280                                     
<a name="l00281"></a>00281                                     $this-&gt;Output = $Template;
<a name="l00282"></a>00282                               }
<a name="l00283"></a>00283                         }
<a name="l00284"></a>00284                         <span class="keywordflow">else</span>
<a name="l00285"></a>00285                         {
<a name="l00286"></a>00286                               $this-&gt;Output = <span class="stringliteral">&#39;{lang:registration_is_disabled}&#39;</span>;
<a name="l00287"></a>00287                         }
<a name="l00288"></a>00288                   }
<a name="l00289"></a>00289                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00290"></a>00290                   {
<a name="l00291"></a>00291                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00292"></a>00292                   }
<a name="l00293"></a>00293             }
<a name="l00294"></a>00294             
<a name="l00313"></a><a class="code" href="classuser__view__1__0__0.html#a9ac2c854de274ad9515727cf4d8deb3c">00313</a>             function                <a class="code" href="classuser__view__1__0__0.html#a9ac2c854de274ad9515727cf4d8deb3c">login_button</a>( $Options )
<a name="l00314"></a>00314             {
<a name="l00315"></a>00315                   <span class="keywordflow">try</span>
<a name="l00316"></a>00316                   {
<a name="l00317"></a>00317                         $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00318"></a>00318                         $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;login_button.tpl&#39;</span> );
<a name="l00319"></a>00319                   }
<a name="l00320"></a>00320                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00321"></a>00321                   {
<a name="l00322"></a>00322                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00323"></a>00323                   }
<a name="l00324"></a>00324             }
<a name="l00325"></a>00325             
<a name="l00344"></a><a class="code" href="classuser__view__1__0__0.html#ad8fba1216911c5efdcd869c5759f3682">00344</a>             function                <a class="code" href="classuser__view__1__0__0.html#ad8fba1216911c5efdcd869c5759f3682">auto_open_login_dialog</a>( $Options )
<a name="l00345"></a>00345             {
<a name="l00346"></a>00346                   <span class="keywordflow">try</span>
<a name="l00347"></a>00347                   {
<a name="l00348"></a>00348                         $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00349"></a>00349                         $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;auto_open_login_dialog.tpl&#39;</span> );
<a name="l00350"></a>00350                   }
<a name="l00351"></a>00351                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00352"></a>00352                   {
<a name="l00353"></a>00353                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00354"></a>00354                   }
<a name="l00355"></a>00355             }
<a name="l00356"></a>00356             
<a name="l00375"></a><a class="code" href="classuser__view__1__0__0.html#a4155bcd78751c81bcce1c4df3bc100d8">00375</a>             function                <a class="code" href="classuser__view__1__0__0.html#a4155bcd78751c81bcce1c4df3bc100d8">logout_button</a>( $Options )
<a name="l00376"></a>00376             {
<a name="l00377"></a>00377                   <span class="keywordflow">try</span>
<a name="l00378"></a>00378                   {
<a name="l00379"></a>00379                         $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00380"></a>00380                         $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;logout_button.tpl&#39;</span> );
<a name="l00381"></a>00381                   }
<a name="l00382"></a>00382                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00383"></a>00383                   {
<a name="l00384"></a>00384                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00385"></a>00385                   }
<a name="l00386"></a>00386             }
<a name="l00387"></a>00387             
<a name="l00406"></a><a class="code" href="classuser__view__1__0__0.html#aa16b3e982656d090386b4c4c5b801cb1">00406</a>             function                <a class="code" href="classuser__view__1__0__0.html#aa16b3e982656d090386b4c4c5b801cb1">switch_user_button</a>( $Options )
<a name="l00407"></a>00407             {
<a name="l00408"></a>00408                   <span class="keywordflow">try</span>
<a name="l00409"></a>00409                   {
<a name="l00410"></a>00410                         $CachedFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00411"></a>00411                         $this-&gt;Output = $CachedFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;switch_user_button.tpl&#39;</span> );
<a name="l00412"></a>00412                   }
<a name="l00413"></a>00413                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00414"></a>00414                   {
<a name="l00415"></a>00415                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00416"></a>00416                   }
<a name="l00417"></a>00417             }
<a name="l00418"></a>00418       
<a name="l00437"></a><a class="code" href="classuser__view__1__0__0.html#a71d0f1b95ab2d95affbcab7b8fed67d9">00437</a>             function                <a class="code" href="classuser__view__1__0__0.html#a71d0f1b95ab2d95affbcab7b8fed67d9">short_profile</a>( $Options )
<a name="l00438"></a>00438             {
<a name="l00439"></a>00439                   <span class="keywordflow">try</span>
<a name="l00440"></a>00440                   {
<a name="l00441"></a>00441                         $UserId = $Options-&gt;get_setting( <span class="stringliteral">&#39;user_id&#39;</span> , <span class="keyword">false</span> );
<a name="l00442"></a>00442                         $User = $this-&gt;UserAlgorithms-&gt;get_by_id( $UserId );
<a name="l00443"></a>00443                         
<a name="l00444"></a>00444                         $this-&gt;Output = $this-&gt;CachedMultyFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;short_profile.tpl&#39;</span> );
<a name="l00445"></a>00445                         $this-&gt;Output = $this-&gt;String-&gt;print_record( $this-&gt;Output , $User );
<a name="l00446"></a>00446                   }
<a name="l00447"></a>00447                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00448"></a>00448                   {
<a name="l00449"></a>00449                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00450"></a>00450                   }
<a name="l00451"></a>00451             }
<a name="l00452"></a>00452             
<a name="l00471"></a><a class="code" href="classuser__view__1__0__0.html#ab7d1fc2007c8c9d76ae10d0e3db70242">00471</a>             function                <a class="code" href="classuser__view__1__0__0.html#ab7d1fc2007c8c9d76ae10d0e3db70242">full_profile</a>( $Options )
<a name="l00472"></a>00472             {
<a name="l00473"></a>00473                   <span class="keywordflow">try</span>
<a name="l00474"></a>00474                   {
<a name="l00475"></a>00475                         <span class="keywordflow">if</span>( $this-&gt;Security-&gt;get_gp( <span class="stringliteral">&#39;login&#39;</span> , <span class="stringliteral">&#39;set&#39;</span> ) )
<a name="l00476"></a>00476                         {
<a name="l00477"></a>00477                               $UserLogin = $this-&gt;Security-&gt;get_gp( <span class="stringliteral">&#39;login&#39;</span> , <span class="stringliteral">&#39;string&#39;</span> );
<a name="l00478"></a>00478                               $User = $this-&gt;UserAccess-&gt;get_user( $UserLogin );
<a name="l00479"></a>00479                         }
<a name="l00480"></a>00480                         <span class="keywordflow">else</span>
<a name="l00481"></a>00481                         {
<a name="l00482"></a>00482                               $UserId = $this-&gt;Security-&gt;get_gp( <span class="stringliteral">&#39;user_id&#39;</span> , <span class="stringliteral">&#39;integer&#39;</span> , 0 );
<a name="l00483"></a>00483                               <span class="keywordflow">if</span>( $UserId == 0 )
<a name="l00484"></a>00484                               {
<a name="l00485"></a>00485                                     $UserId = $this-&gt;UserAlgorithms-&gt;get_id();
<a name="l00486"></a>00486                               }
<a name="l00487"></a>00487                               
<a name="l00488"></a>00488                               $User = $this-&gt;UserAlgorithms-&gt;get_by_id( $UserId );
<a name="l00489"></a>00489                         }
<a name="l00490"></a>00490                         
<a name="l00491"></a>00491                         $this-&gt;Output = $this-&gt;CachedMultyFS-&gt;get_template( __FILE__ , <span class="stringliteral">&#39;full_profile.tpl&#39;</span> );
<a name="l00492"></a>00492                         $this-&gt;Output = $this-&gt;String-&gt;print_record( $this-&gt;Output , $User );
<a name="l00493"></a>00493                   }
<a name="l00494"></a>00494                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00495"></a>00495                   {
<a name="l00496"></a>00496                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00497"></a>00497                   }
<a name="l00498"></a>00498             }
<a name="l00499"></a>00499             
<a name="l00518"></a><a class="code" href="classuser__view__1__0__0.html#ae6abbcc78386c6d9b18ec35112b03de6">00518</a>             function                <a class="code" href="classuser__view__1__0__0.html#ae6abbcc78386c6d9b18ec35112b03de6">update_user_form</a>( $Options )
<a name="l00519"></a>00519             {
<a name="l00520"></a>00520                   <span class="keywordflow">try</span>
<a name="l00521"></a>00521                   {
<a name="l00522"></a>00522                         $Path = <a class="code" href="core_8php.html#a5723fd5d1f06ff63181f91d948316d87">_get_package_relative_path_ex</a>( <span class="stringliteral">&#39;user::user_manager::user_manager_view&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> );
<a name="l00523"></a>00523                         $TemplatePath = $Path.<span class="stringliteral">&#39;/res/templates/update_user_form.tpl&#39;</span>;
<a name="l00524"></a>00524                         $Template = $this-&gt;CachedMultyFS-&gt;file_get_contents( $TemplatePath );
<a name="l00525"></a>00525                         
<a name="l00526"></a>00526                         $User = $this-&gt;UserAlgorithms-&gt;get_user();
<a name="l00527"></a>00527                         $this-&gt;Output = $this-&gt;String-&gt;print_record( $Template , $User );
<a name="l00528"></a>00528                         $this-&gt;Output = str_replace( <span class="stringliteral">&#39;{prefix}&#39;</span> , <span class="stringliteral">&#39;user&#39;</span> , $this-&gt;Output );
<a name="l00529"></a>00529                         $Changed = <span class="keyword">false</span>;
<a name="l00530"></a>00530                         $this-&gt;Output = $this-&gt;String-&gt;hide_block( 
<a name="l00531"></a>00531                               $this-&gt;Output , <span class="stringliteral">&#39;permit:user_manager&#39;</span> , <span class="stringliteral">&#39;permit:~user_manager&#39;</span> , $Changed
<a name="l00532"></a>00532                         );
<a name="l00533"></a>00533                         
<a name="l00534"></a>00534                         $ContextSetUtilities = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;gui::context_set::context_set_utilities&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00535"></a>00535                         $this-&gt;Output = $ContextSetUtilities-&gt;set_form_data( $this-&gt;Output , $User );
<a name="l00536"></a>00536                   }
<a name="l00537"></a>00537                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00538"></a>00538                   {
<a name="l00539"></a>00539                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00540"></a>00540                   }
<a name="l00541"></a>00541             }
<a name="l00542"></a>00542             
<a name="l00565"></a><a class="code" href="classuser__view__1__0__0.html#a43074158f41bf195878c903457afa35f">00565</a>             function                <a class="code" href="classuser__view__1__0__0.html#a43074158f41bf195878c903457afa35f">view</a>( $Options )
<a name="l00566"></a>00566             {
<a name="l00567"></a>00567                   <span class="keywordflow">try</span>
<a name="l00568"></a>00568                   {
<a name="l00569"></a>00569                         $ContextSet = <a class="code" href="core__public__api_8php.html#a7dbfff8b452767e03ec52155dff6bdd3">get_package_object</a>( <span class="stringliteral">&#39;gui::context_set&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00570"></a>00570                         
<a name="l00571"></a>00571                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_login_form&#39;</span> );
<a name="l00572"></a>00572                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_logout_form&#39;</span> );
<a name="l00573"></a>00573                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_registration_form&#39;</span> );
<a name="l00574"></a>00574                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_login_button&#39;</span> );
<a name="l00575"></a>00575                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_auto_open_login_dialog&#39;</span> );
<a name="l00576"></a>00576                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_logout_button&#39;</span> );
<a name="l00577"></a>00577                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_switch_user_button&#39;</span> );
<a name="l00578"></a>00578                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_switch_user&#39;</span> );
<a name="l00579"></a>00579                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_short_profile&#39;</span> );
<a name="l00580"></a>00580                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_full_profile&#39;</span> );
<a name="l00581"></a>00581                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcx_update_user_form&#39;</span> );
<a name="l00582"></a>00582                         $ContextSet-&gt;add_context( dirname( __FILE__ ).<span class="stringliteral">&#39;/conf/cfcxs_user_line&#39;</span> );
<a name="l00583"></a>00583                         
<a name="l00584"></a>00584                         $ContextSet-&gt;execute( $Options , $this , __FILE__ );
<a name="l00585"></a>00585                         
<a name="l00586"></a>00586                         <span class="keywordflow">return</span>( $this-&gt;Output );
<a name="l00587"></a>00587                   }
<a name="l00588"></a>00588                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00589"></a>00589                   {
<a name="l00590"></a>00590                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00591"></a>00591                   }
<a name="l00592"></a>00592             }
<a name="l00593"></a>00593             
<a name="l00620"></a><a class="code" href="classuser__view__1__0__0.html#a2ad173e7775449b12ef465870d24a261">00620</a>             function                <a class="code" href="classuser__view__1__0__0.html#a2ad173e7775449b12ef465870d24a261">process_auth</a>( $Str , $Changed )
<a name="l00621"></a>00621             {
<a name="l00622"></a>00622                   <span class="keywordflow">try</span>
<a name="l00623"></a>00623                   {
<a name="l00624"></a>00624                         <span class="keywordflow">if</span>( $this-&gt;UserAlgorithms-&gt;get_login() != <span class="stringliteral">&#39;guest&#39;</span> )
<a name="l00625"></a>00625                         {
<a name="l00626"></a>00626                               <span class="keywordflow">if</span>( strpos( $Str , <span class="stringliteral">&#39;{session_login}&#39;</span> ) !== false )
<a name="l00627"></a>00627                               {
<a name="l00628"></a>00628                                     $Str = str_replace( <span class="stringliteral">&#39;{session_login}&#39;</span> , $this-&gt;UserAlgorithms-&gt;get_login() , $Str );
<a name="l00629"></a>00629                                     $Changed = <span class="keyword">true</span>;
<a name="l00630"></a>00630                               }
<a name="l00631"></a>00631                         }
<a name="l00632"></a>00632                         
<a name="l00633"></a>00633                         <span class="keywordflow">return</span>( array( $Str , $Changed ) );
<a name="l00634"></a>00634                   }
<a name="l00635"></a>00635                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00636"></a>00636                   {
<a name="l00637"></a>00637                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00638"></a>00638                   }
<a name="l00639"></a>00639             }
<a name="l00640"></a>00640             
<a name="l00667"></a><a class="code" href="classuser__view__1__0__0.html#a3b0e298a9f9de90e2caa7878feec0c15">00667</a>             function                <a class="code" href="classuser__view__1__0__0.html#a3b0e298a9f9de90e2caa7878feec0c15">process_user_id</a>( $Str , $Changed )
<a name="l00668"></a>00668             {
<a name="l00669"></a>00669                   <span class="keywordflow">try</span>
<a name="l00670"></a>00670                   {
<a name="l00671"></a>00671                         <span class="keywordflow">if</span>( strpos( $Str , <span class="stringliteral">&#39;{user_id}&#39;</span> ) !== <span class="keyword">false</span> )
<a name="l00672"></a>00672                         {
<a name="l00673"></a>00673                               $Str = str_replace( <span class="stringliteral">&#39;{user_id}&#39;</span> , $this-&gt;UserAlgorithms-&gt;get_id() , $Str );
<a name="l00674"></a>00674                               $Changed = <span class="keyword">true</span>;
<a name="l00675"></a>00675                         }
<a name="l00676"></a>00676                         
<a name="l00677"></a>00677                         <span class="keywordflow">return</span>( array( $Str , $Changed ) );
<a name="l00678"></a>00678                   }
<a name="l00679"></a>00679                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00680"></a>00680                   {
<a name="l00681"></a>00681                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00682"></a>00682                   }
<a name="l00683"></a>00683             }
<a name="l00684"></a>00684             
<a name="l00711"></a><a class="code" href="classuser__view__1__0__0.html#a60d8502d244327733f6382f4b9f0ce49">00711</a>             function                <a class="code" href="classuser__view__1__0__0.html#a60d8502d244327733f6382f4b9f0ce49">process_session_login</a>( $Str , $Changed )
<a name="l00712"></a>00712             {
<a name="l00713"></a>00713                   <span class="keywordflow">try</span>
<a name="l00714"></a>00714                   {
<a name="l00715"></a>00715                         $Mode = $this-&gt;UserAlgorithms-&gt;logged_in() ? <span class="stringliteral">&#39;logged_in&#39;</span> : <span class="stringliteral">&#39;guest&#39;</span>;
<a name="l00716"></a>00716                         $AdditionalMode = $this-&gt;UserAlgorithms-&gt;logged_in() ? <span class="stringliteral">&#39;guest&#39;</span> : <span class="stringliteral">&#39;logged_in&#39;</span>;
<a name="l00717"></a>00717                         
<a name="l00718"></a>00718                         <span class="keywordflow">if</span>( $this-&gt;String-&gt;block_exists( $Str , <span class="stringliteral">&#39;auth:&#39;</span>.$Mode , <span class="stringliteral">&#39;auth:~&#39;</span>.$Mode ) )
<a name="l00719"></a>00719                         {
<a name="l00720"></a>00720                               $Str = $this-&gt;String-&gt;show_block( $Str , <span class="stringliteral">&#39;auth:&#39;</span>.$Mode , <span class="stringliteral">&#39;auth:~&#39;</span>.$Mode , $Changed );
<a name="l00721"></a>00721                         }
<a name="l00722"></a>00722 
<a name="l00723"></a>00723                         <span class="keywordflow">if</span>( $this-&gt;String-&gt;block_exists( $Str , <span class="stringliteral">&#39;auth:&#39;</span>.$AdditionalMode , <span class="stringliteral">&#39;auth:~&#39;</span>.$AdditionalMode ) )
<a name="l00724"></a>00724                         {
<a name="l00725"></a>00725                               $Str = $this-&gt;String-&gt;hide_block( 
<a name="l00726"></a>00726                                     $Str , <span class="stringliteral">&#39;auth:&#39;</span>.$AdditionalMode , <span class="stringliteral">&#39;auth:~&#39;</span>.$AdditionalMode , $Changed
<a name="l00727"></a>00727                               );
<a name="l00728"></a>00728                         }
<a name="l00729"></a>00729                         
<a name="l00730"></a>00730                         <span class="keywordflow">if</span>( $this-&gt;UserAlgorithms-&gt;logged_in() )
<a name="l00731"></a>00731                         {
<a name="l00732"></a>00732                               $Str = str_replace( <span class="stringliteral">&#39;{session_login}&#39;</span> , $this-&gt;UserAlgorithms-&gt;get_login() , $Str );
<a name="l00733"></a>00733                         }
<a name="l00734"></a>00734                         
<a name="l00735"></a>00735                         <span class="keywordflow">return</span>( array( $Str , $Changed ) );
<a name="l00736"></a>00736                   }
<a name="l00737"></a>00737                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00738"></a>00738                   {
<a name="l00739"></a>00739                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00740"></a>00740                   }
<a name="l00741"></a>00741             }
<a name="l00742"></a>00742             
<a name="l00773"></a><a class="code" href="classuser__view__1__0__0.html#a94fe2812ad7ca1968e089b62f7fcd428">00773</a>             function                <a class="code" href="classuser__view__1__0__0.html#a94fe2812ad7ca1968e089b62f7fcd428">process_buttons</a>( $Options , $Str , $Changed )
<a name="l00774"></a>00774             {
<a name="l00775"></a>00775                   <span class="keywordflow">try</span>
<a name="l00776"></a>00776                   {
<a name="l00777"></a>00777                         <span class="keywordflow">if</span>( strpos( $Str , <span class="stringliteral">&#39;{logout_button}&#39;</span> ) !== <span class="keyword">false</span> )
<a name="l00778"></a>00778                         {
<a name="l00779"></a>00779                               $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a4155bcd78751c81bcce1c4df3bc100d8">logout_button</a>( $Options );
<a name="l00780"></a>00780                               $Str = str_replace( <span class="stringliteral">&#39;{logout_button}&#39;</span> , $this-&gt;Output , $Str );
<a name="l00781"></a>00781                         }
<a name="l00782"></a>00782                         
<a name="l00783"></a>00783                         <span class="keywordflow">if</span>( strpos( $Str , <span class="stringliteral">&#39;{login_button}&#39;</span> ) !== <span class="keyword">false</span> )
<a name="l00784"></a>00784                         {
<a name="l00785"></a>00785                               $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a9ac2c854de274ad9515727cf4d8deb3c">login_button</a>( $Options );
<a name="l00786"></a>00786                               $Str = str_replace( <span class="stringliteral">&#39;{login_button}&#39;</span> , $this-&gt;Output , $Str );
<a name="l00787"></a>00787                         }
<a name="l00788"></a>00788                         
<a name="l00789"></a>00789                         <span class="keywordflow">if</span>( strpos( $Str , <span class="stringliteral">&#39;{auto_open_login_dialog}&#39;</span> ) !== <span class="keyword">false</span> )
<a name="l00790"></a>00790                         {
<a name="l00791"></a>00791                               $this-&gt;<a class="code" href="classuser__view__1__0__0.html#ad8fba1216911c5efdcd869c5759f3682">auto_open_login_dialog</a>( $Options );
<a name="l00792"></a>00792                               $Str = str_replace( <span class="stringliteral">&#39;{auto_open_login_dialog}&#39;</span> , $this-&gt;Output , $Str );
<a name="l00793"></a>00793                         }
<a name="l00794"></a>00794                         
<a name="l00795"></a>00795                         <span class="keywordflow">if</span>( strpos( $Str , <span class="stringliteral">&#39;{switch_user_button}&#39;</span> ) !== <span class="keyword">false</span> )
<a name="l00796"></a>00796                         {
<a name="l00797"></a>00797                               $this-&gt;<a class="code" href="classuser__view__1__0__0.html#aa16b3e982656d090386b4c4c5b801cb1">switch_user_button</a>( $Options );
<a name="l00798"></a>00798                               $Str = str_replace( <span class="stringliteral">&#39;{switch_user_button}&#39;</span> , $this-&gt;Output , $Str );
<a name="l00799"></a>00799                         }
<a name="l00800"></a>00800                         
<a name="l00801"></a>00801                         <span class="keywordflow">return</span>( array( $Str , $Changed ) );
<a name="l00802"></a>00802                   }
<a name="l00803"></a>00803                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00804"></a>00804                   {
<a name="l00805"></a>00805                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00806"></a>00806                   }
<a name="l00807"></a>00807             }
<a name="l00808"></a>00808             
<a name="l00831"></a><a class="code" href="classuser__view__1__0__0.html#a852dd957422fc6dbd32074e7c42ca46e">00831</a>             function                <a class="code" href="classuser__view__1__0__0.html#a852dd957422fc6dbd32074e7c42ca46e">fetch_users</a>( <a class="code" href="classuser__view__1__0__0.html#a42734c34e5429a8ec8d5dc3ff7331492">$BlockSettings</a> )
<a name="l00832"></a>00832             {
<a name="l00833"></a>00833                   <span class="keywordflow">try</span>
<a name="l00834"></a>00834                   {
<a name="l00835"></a>00835                         $PermitFilter = <a class="code" href="classuser__view__1__0__0.html#a42734c34e5429a8ec8d5dc3ff7331492">$BlockSettings</a>-&gt;get_setting( <span class="stringliteral">&#39;permit_filter&#39;</span> , <span class="keyword">false</span> );
<a name="l00836"></a>00836                         
<a name="l00837"></a>00837                         <span class="keywordflow">if</span>( $PermitFilter !== <span class="keyword">false</span> )
<a name="l00838"></a>00838                         {
<a name="l00839"></a>00839                               $Users = $this-&gt;PermitAlgorithms-&gt;get_users_for_permit( $PermitFilter );
<a name="l00840"></a>00840                         }
<a name="l00841"></a>00841                         <span class="keywordflow">else</span>
<a name="l00842"></a>00842                         {
<a name="l00843"></a>00843                               <span class="comment">/* all users */</span>
<a name="l00844"></a>00844                               $Users = $this-&gt;PermitAlgorithms-&gt;get_users_for_permit( <span class="stringliteral">&#39;registered&#39;</span> );
<a name="l00845"></a>00845                         }
<a name="l00846"></a>00846                         
<a name="l00847"></a>00847                         <span class="keywordflow">return</span>( $Users );
<a name="l00848"></a>00848                   }
<a name="l00849"></a>00849                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00850"></a>00850                   {
<a name="l00851"></a>00851                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00852"></a>00852                   }
<a name="l00853"></a>00853             }
<a name="l00854"></a>00854             
<a name="l00881"></a><a class="code" href="classuser__view__1__0__0.html#a151f8409de75c37792025e9fbe86be07">00881</a>             function                <a class="code" href="classuser__view__1__0__0.html#a151f8409de75c37792025e9fbe86be07">process_user_list</a>( $Str , $Changed )
<a name="l00882"></a>00882             {
<a name="l00883"></a>00883                   <span class="keywordflow">try</span>
<a name="l00884"></a>00884                   {
<a name="l00885"></a>00885                         <span class="keywordflow">for</span>( ; $Parameters = $this-&gt;String-&gt;get_macro_parameters( $Str , <span class="stringliteral">&#39;user_list&#39;</span> ) ; )
<a name="l00886"></a>00886                         {
<a name="l00887"></a>00887                               $this-&gt;BlockSettings-&gt;load_settings( $Parameters );
<a name="l00888"></a>00888 
<a name="l00889"></a>00889                               $Users = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a852dd957422fc6dbd32074e7c42ca46e">fetch_users</a>( $this-&gt;BlockSettings );
<a name="l00890"></a>00890                               $Name = $this-&gt;BlockSettings-&gt;get_setting( <span class="stringliteral">&#39;name&#39;</span> );
<a name="l00891"></a>00891                               $Field = $this-&gt;BlockSettings-&gt;get_setting( <span class="stringliteral">&#39;field&#39;</span> , <span class="stringliteral">&#39;login&#39;</span> );
<a name="l00892"></a>00892                               
<a name="l00893"></a>00893                               $Code = <span class="stringliteral">&#39;&#39;</span>;
<a name="l00894"></a>00894                               
<a name="l00895"></a>00895                               <span class="keywordflow">foreach</span>( $Users as $i =&gt; $id )
<a name="l00896"></a>00896                               {
<a name="l00897"></a>00897                                     $User = $this-&gt;UserAlgorithms-&gt;get_by_id( $id );
<a name="l00898"></a>00898                                     $Code .= <span class="stringliteral">&quot;{checkbox:name=_$Name&quot;</span>.get_field( $User , <span class="stringliteral">&#39;id&#39;</span> ).<span class="stringliteral">&quot;;current_value=on}&quot;</span>.
<a name="l00899"></a>00899                                                  <a class="code" href="functional__programming_8php.html#a113f39218a0e805d475fbc5ab87a16ab">get_field</a>( $User , $Field ).<span class="stringliteral">&quot;&lt;br&gt;&quot;</span>;
<a name="l00900"></a>00900                               }
<a name="l00901"></a>00901                               
<a name="l00902"></a>00902                               $Str = str_replace( <span class="stringliteral">&quot;{user_list:$Parameters}&quot;</span> , $Code , $Str );
<a name="l00903"></a>00903                               $Changed = <span class="keyword">true</span>;
<a name="l00904"></a>00904                         }
<a name="l00905"></a>00905                         
<a name="l00906"></a>00906                         <span class="keywordflow">return</span>( array( $Str , $Changed ) );
<a name="l00907"></a>00907                   }
<a name="l00908"></a>00908                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00909"></a>00909                   {
<a name="l00910"></a>00910                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00911"></a>00911                   }
<a name="l00912"></a>00912             }
<a name="l00913"></a>00913             
<a name="l00940"></a><a class="code" href="classuser__view__1__0__0.html#a97080497a245efd2d146ba02be2c32e0">00940</a>             function                <a class="code" href="classuser__view__1__0__0.html#a97080497a245efd2d146ba02be2c32e0">process_months_on_site</a>( $Str , $Changed )
<a name="l00941"></a>00941             {
<a name="l00942"></a>00942                   <span class="keywordflow">try</span>
<a name="l00943"></a>00943                   {
<a name="l00944"></a>00944                         <span class="keywordflow">for</span>( ; $Parameters = $this-&gt;String-&gt;get_macro_parameters( $Str , <span class="stringliteral">&#39;months_on_site&#39;</span> ) ; )
<a name="l00945"></a>00945                         {
<a name="l00946"></a>00946                               $this-&gt;BlockSettings-&gt;load_settings( $Parameters );
<a name="l00947"></a>00947                               
<a name="l00948"></a>00948                               $User = $this-&gt;UserAlgorithms-&gt;get_by_id( $this-&gt;BlockSettings-&gt;get_setting( <span class="stringliteral">&#39;user_id&#39;</span> ) );
<a name="l00949"></a>00949                               
<a name="l00950"></a>00950                               $Code = time() - strtotime( <a class="code" href="functional__programming_8php.html#a113f39218a0e805d475fbc5ab87a16ab">get_field</a>( $User , <span class="stringliteral">&#39;registered&#39;</span> ) );
<a name="l00951"></a>00951                               $Code = intval( $Code / ( 30 * 24 * 60 * 60 ) );
<a name="l00952"></a>00952                               
<a name="l00953"></a>00953                               $Str = str_replace( <span class="stringliteral">&quot;{months_on_site:$Parameters}&quot;</span> , $Code , $Str );
<a name="l00954"></a>00954                               $Changed = <span class="keyword">true</span>;
<a name="l00955"></a>00955                         }
<a name="l00956"></a>00956                         
<a name="l00957"></a>00957                         <span class="keywordflow">return</span>( array( $Str , $Changed ) );
<a name="l00958"></a>00958                   }
<a name="l00959"></a>00959                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00960"></a>00960                   {
<a name="l00961"></a>00961                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00962"></a>00962                   }
<a name="l00963"></a>00963             }
<a name="l00964"></a>00964             
<a name="l00991"></a><a class="code" href="classuser__view__1__0__0.html#a5de4fbead909fb6daf0567865ef8fe10">00991</a>             function                <a class="code" href="classuser__view__1__0__0.html#a5de4fbead909fb6daf0567865ef8fe10">process_user_login</a>( $Str , $Changed )
<a name="l00992"></a>00992             {
<a name="l00993"></a>00993                   <span class="keywordflow">try</span>
<a name="l00994"></a>00994                   {
<a name="l00995"></a>00995                         <span class="keywordflow">for</span>( ; $Parameters = $this-&gt;String-&gt;get_macro_parameters( $Str , <span class="stringliteral">&#39;user_login&#39;</span> ) ; )
<a name="l00996"></a>00996                         {
<a name="l00997"></a>00997                               $this-&gt;BlockSettings-&gt;load_settings( $Parameters );
<a name="l00998"></a>00998                               
<a name="l00999"></a>00999                               $User = $this-&gt;UserAlgorithms-&gt;get_by_id( $this-&gt;BlockSettings-&gt;get_setting( <span class="stringliteral">&#39;user_id&#39;</span> ) );
<a name="l01000"></a>01000                               
<a name="l01001"></a>01001                               $Str = str_replace( <span class="stringliteral">&quot;{user_login:$Parameters}&quot;</span> , <a class="code" href="functional__programming_8php.html#a113f39218a0e805d475fbc5ab87a16ab">get_field</a>( $User , <span class="stringliteral">&#39;login&#39;</span> ) , $Str );
<a name="l01002"></a>01002                               $Changed = <span class="keyword">true</span>;
<a name="l01003"></a>01003                         }
<a name="l01004"></a>01004                         
<a name="l01005"></a>01005                         <span class="keywordflow">return</span>( array( $Str , $Changed ) );
<a name="l01006"></a>01006                   }
<a name="l01007"></a>01007                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l01008"></a>01008                   {
<a name="l01009"></a>01009                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l01010"></a>01010                   }
<a name="l01011"></a>01011             }
<a name="l01012"></a>01012             
<a name="l01043"></a><a class="code" href="classuser__view__1__0__0.html#a19e4020eef3ee72db80f07869a5d299e">01043</a>             function                <a class="code" href="classuser__view__1__0__0.html#a19e4020eef3ee72db80f07869a5d299e">process_string</a>( $Options , $Str , &amp;$Changed )
<a name="l01044"></a>01044             {
<a name="l01045"></a>01045                   <span class="keywordflow">try</span>
<a name="l01046"></a>01046                   {
<a name="l01047"></a>01047                         list( $Str , $Changed ) = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a2ad173e7775449b12ef465870d24a261">process_auth</a>( $Str , $Changed );
<a name="l01048"></a>01048                         
<a name="l01049"></a>01049                         $Str = $this-&gt;GUI-&gt;process_common_widgets( __FILE__ , <span class="stringliteral">&#39;user&#39;</span> , $Str , $Changed );
<a name="l01050"></a>01050 
<a name="l01051"></a>01051                         list( $Str , $Changed ) = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a94fe2812ad7ca1968e089b62f7fcd428">process_buttons</a>( $Options , $Str , $Changed );
<a name="l01052"></a>01052 
<a name="l01053"></a>01053                         list( $Str , $Changed ) = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a151f8409de75c37792025e9fbe86be07">process_user_list</a>( $Str , $Changed );
<a name="l01054"></a>01054                         
<a name="l01055"></a>01055                         list( $Str , $Changed ) = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a97080497a245efd2d146ba02be2c32e0">process_months_on_site</a>( $Str , $Changed );
<a name="l01056"></a>01056                         
<a name="l01057"></a>01057                         list( $Str , $Changed ) = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a3b0e298a9f9de90e2caa7878feec0c15">process_user_id</a>( $Str , $Changed );
<a name="l01058"></a>01058                         
<a name="l01059"></a>01059                         list( $Str , $Changed ) = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a60d8502d244327733f6382f4b9f0ce49">process_session_login</a>( $Str , $Changed );
<a name="l01060"></a>01060                         
<a name="l01061"></a>01061                         list( $Str , $Changed ) = $this-&gt;<a class="code" href="classuser__view__1__0__0.html#a5de4fbead909fb6daf0567865ef8fe10">process_user_login</a>( $Str , $Changed );
<a name="l01062"></a>01062                         
<a name="l01063"></a>01063                         <span class="keywordflow">return</span>( $Str );
<a name="l01064"></a>01064                   }
<a name="l01065"></a>01065                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l01066"></a>01066                   {
<a name="l01067"></a>01067                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l01068"></a>01068                   }
<a name="l01069"></a>01069             }
<a name="l01070"></a>01070       }
<a name="l01071"></a>01071 ?&gt;
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 3 2011 14:49:56 for ultimix by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
