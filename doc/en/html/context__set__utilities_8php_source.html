<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ultimix: G:/projects/webdev/wwwroot/ultimix/packages/gui/packages/context_set/packages/context_set_utilities/context_set_utilities.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>G:/projects/webdev/wwwroot/ultimix/packages/gui/packages/context_set/packages/context_set_utilities/context_set_utilities.php</h1>  </div>
</div>
<div class="contents">
<a href="context__set__utilities_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003       <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment">      *     This source code is a part of the Ultimix Project. </span>
<a name="l00005"></a>00005 <span class="comment">      *     It is distributed under BSD license. All other third side source code (like tinyMCE) is distributed under </span>
<a name="l00006"></a>00006 <span class="comment">      *     it&#39;s own license wich could be found from the corresponding files or sources. </span>
<a name="l00007"></a>00007 <span class="comment">      *     This source code is provided &quot;as is&quot; without any warranties or garanties.</span>
<a name="l00008"></a>00008 <span class="comment">      *</span>
<a name="l00009"></a>00009 <span class="comment">      *     Have a nice day!</span>
<a name="l00010"></a>00010 <span class="comment">      *</span>
<a name="l00011"></a>00011 <span class="comment">      *     @url http://ultimix.sorceforge.net</span>
<a name="l00012"></a>00012 <span class="comment">      *</span>
<a name="l00013"></a>00013 <span class="comment">      *     @author Alexey &quot;gdever&quot; Dodonov</span>
<a name="l00014"></a>00014 <span class="comment">      */</span>
<a name="l00015"></a>00015 
<a name="l00026"></a><a class="code" href="classcontext__set__utilities__1__0__0.html">00026</a>       <span class="keyword">class </span><a class="code" href="classcontext__set__utilities__1__0__0.html">context_set_utilities_1_0_0</a>{
<a name="l00027"></a>00027       
<a name="l00038"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a1b21a3420462aafbfb9e6420c224452d">00038</a>             var                           <a class="code" href="classcontext__set__utilities__1__0__0.html#a1b21a3420462aafbfb9e6420c224452d">$CachedMultyFS</a> = <span class="keyword">false</span>;
<a name="l00039"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a524e5510549d6b36c3f6a9e025faca4e">00039</a>             var                           <a class="code" href="classcontext__set__utilities__1__0__0.html#a524e5510549d6b36c3f6a9e025faca4e">$PageComposer</a> = <span class="keyword">false</span>;
<a name="l00040"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#aaae5f70ebc2b60f22e8159944cd2d518">00040</a>             var                           <a class="code" href="classcontext__set__utilities__1__0__0.html#aaae5f70ebc2b60f22e8159944cd2d518">$Security</a> = <span class="keyword">false</span>;
<a name="l00041"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a541f49d5b9cf7bae2f91f639abcf3458">00041</a>             var                           <a class="code" href="classcontext__set__utilities__1__0__0.html#a541f49d5b9cf7bae2f91f639abcf3458">$String</a> = <span class="keyword">false</span>;
<a name="l00042"></a>00042       
<a name="l00057"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a095c5d389db211932136b53f25f39685">00057</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a095c5d389db211932136b53f25f39685">__construct</a>()
<a name="l00058"></a>00058             {
<a name="l00059"></a>00059                   <span class="keywordflow">try</span>
<a name="l00060"></a>00060                   {
<a name="l00061"></a>00061                         $this-&gt;CachedMultyFS = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;cached_multy_fs&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00062"></a>00062                         $this-&gt;PageComposer = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;page::page_composer&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00063"></a>00063                         $this-&gt;Security = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;security&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00064"></a>00064                         $this-&gt;String = <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( <span class="stringliteral">&#39;string&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00065"></a>00065                   }
<a name="l00066"></a>00066                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00067"></a>00067                   {
<a name="l00068"></a>00068                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00069"></a>00069                   }
<a name="l00070"></a>00070             }
<a name="l00071"></a>00071       
<a name="l00094"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a9c0f71280d9a8edfb884c1d8e8ad21bb">00094</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a9c0f71280d9a8edfb884c1d8e8ad21bb">set_header_template</a>( $Options , &amp;$Paging )
<a name="l00095"></a>00095             {
<a name="l00096"></a>00096                   <span class="keywordflow">try</span>
<a name="l00097"></a>00097                   {
<a name="l00098"></a>00098                         $FileName = $Options-&gt;get_setting( <span class="stringliteral">&#39;header&#39;</span> , <span class="stringliteral">&#39;header.tpl&#39;</span> );
<a name="l00099"></a>00099                         $Path = dirname( $Options-&gt;get_setting( <span class="stringliteral">&#39;file_path&#39;</span> ) ).<span class="stringliteral">&quot;/res/templates/$FileName&quot;</span>;
<a name="l00100"></a>00100                         $Header = $this-&gt;CachedMultyFS-&gt;file_get_contents( $Path );
<a name="l00101"></a>00101                         
<a name="l00102"></a>00102                         $Paging-&gt;set( <span class="stringliteral">&#39;Header&#39;</span> , $Header );
<a name="l00103"></a>00103                   }
<a name="l00104"></a>00104                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00105"></a>00105                   {
<a name="l00106"></a>00106                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00107"></a>00107                   }
<a name="l00108"></a>00108             }
<a name="l00109"></a>00109       
<a name="l00132"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a1d3815f7100cded65b1519414760839b">00132</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a1d3815f7100cded65b1519414760839b">set_item_template</a>( $Options , &amp;$Paging )
<a name="l00133"></a>00133             {
<a name="l00134"></a>00134                   <span class="keywordflow">try</span>
<a name="l00135"></a>00135                   {
<a name="l00136"></a>00136                         $FileName = $Options-&gt;get_setting( <span class="stringliteral">&#39;item&#39;</span> , <span class="stringliteral">&#39;item.tpl&#39;</span> );
<a name="l00137"></a>00137                         $Path = dirname( $Options-&gt;get_setting( <span class="stringliteral">&#39;file_path&#39;</span> ) ).<span class="stringliteral">&quot;/res/templates/$FileName&quot;</span>;
<a name="l00138"></a>00138                         $Item = $this-&gt;CachedMultyFS-&gt;file_get_contents( $Path );
<a name="l00139"></a>00139                         
<a name="l00140"></a>00140                         $Paging-&gt;set( <span class="stringliteral">&#39;ItemTemplate&#39;</span> , $Item );
<a name="l00141"></a>00141                   }
<a name="l00142"></a>00142                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00143"></a>00143                   {
<a name="l00144"></a>00144                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00145"></a>00145                   }
<a name="l00146"></a>00146             }
<a name="l00147"></a>00147       
<a name="l00170"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#afe702da7071ccf72cf8e16ac7bd91874">00170</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#afe702da7071ccf72cf8e16ac7bd91874">set_no_data_found_message</a>( $Options , &amp;$Paging )
<a name="l00171"></a>00171             {
<a name="l00172"></a>00172                   <span class="keywordflow">try</span>
<a name="l00173"></a>00173                   {
<a name="l00174"></a>00174                         <span class="keywordflow">if</span>( $FileName = $Options-&gt;get_setting( <span class="stringliteral">&#39;no_data_found_message&#39;</span> , <span class="keyword">false</span> ) )
<a name="l00175"></a>00175                         {
<a name="l00176"></a>00176                               $Path = dirname( $Options-&gt;get_setting( <span class="stringliteral">&#39;file_path&#39;</span> ) ).<span class="stringliteral">&quot;/res/templates/$FileName&quot;</span>;
<a name="l00177"></a>00177                         }
<a name="l00178"></a>00178                         <span class="keywordflow">else</span>
<a name="l00179"></a>00179                         {
<a name="l00180"></a>00180                               $Path = dirname( __FILE__ ).<span class="stringliteral">&quot;/res/templates/default_no_data_found_message.tpl&quot;</span>;
<a name="l00181"></a>00181                         }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183                         $NoDataFoundTemplate = $this-&gt;CachedMultyFS-&gt;file_get_contents( $Path );
<a name="l00184"></a>00184                         
<a name="l00185"></a>00185                         $Paging-&gt;set( <span class="stringliteral">&#39;NoDataFoundMessage&#39;</span> , $NoDataFoundTemplate );
<a name="l00186"></a>00186                   }
<a name="l00187"></a>00187                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00188"></a>00188                   {
<a name="l00189"></a>00189                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00190"></a>00190                   }
<a name="l00191"></a>00191             }
<a name="l00192"></a>00192       
<a name="l00215"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#ac82715abe648e20c2cc5a5c8e7455189">00215</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#ac82715abe648e20c2cc5a5c8e7455189">set_footer_template</a>( $Options , &amp;$Paging )
<a name="l00216"></a>00216             {
<a name="l00217"></a>00217                   <span class="keywordflow">try</span>
<a name="l00218"></a>00218                   {
<a name="l00219"></a>00219                         $FileName = $Options-&gt;get_setting( <span class="stringliteral">&#39;footer&#39;</span> , <span class="stringliteral">&#39;footer.tpl&#39;</span> );
<a name="l00220"></a>00220                         $Path = dirname( $Options-&gt;get_setting( <span class="stringliteral">&#39;file_path&#39;</span> ) ).<span class="stringliteral">&quot;/res/templates/$FileName&quot;</span>;
<a name="l00221"></a>00221                         $Footer = $this-&gt;CachedMultyFS-&gt;file_get_contents( $Path );
<a name="l00222"></a>00222 
<a name="l00223"></a>00223                         $Paging-&gt;set( <span class="stringliteral">&#39;Footer&#39;</span> , $Footer );
<a name="l00224"></a>00224                   }
<a name="l00225"></a>00225                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00226"></a>00226                   {
<a name="l00227"></a>00227                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00228"></a>00228                   }
<a name="l00229"></a>00229             }
<a name="l00230"></a>00230             
<a name="l00253"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a5be84375b0a55ded7f5adf3735b08e67">00253</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a5be84375b0a55ded7f5adf3735b08e67">set_main_settings</a>( $Options , &amp;$Paging )
<a name="l00254"></a>00254             {
<a name="l00255"></a>00255                   <span class="keywordflow">try</span>
<a name="l00256"></a>00256                   {
<a name="l00257"></a>00257                         $Paging-&gt;set( <span class="stringliteral">&#39;RecordsPerPage&#39;</span> , $Options-&gt;get_setting( <span class="stringliteral">&#39;records_per_page&#39;</span> , 20 ) );
<a name="l00258"></a>00258                         
<a name="l00259"></a>00259                         $Paging-&gt;set( <span class="stringliteral">&#39;PageField&#39;</span> , $Options-&gt;get_setting( <span class="stringliteral">&#39;page_field&#39;</span> , <span class="stringliteral">&#39;page&#39;</span> ) );
<a name="l00260"></a>00260                   }
<a name="l00261"></a>00261                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00262"></a>00262                   {
<a name="l00263"></a>00263                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00264"></a>00264                   }
<a name="l00265"></a>00265             }
<a name="l00266"></a>00266       
<a name="l00293"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a9fea23a40bcc90e270cea9bd5512f011">00293</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a9fea23a40bcc90e270cea9bd5512f011">get_original_records</a>( &amp;$Options , $IdList )
<a name="l00294"></a>00294             {
<a name="l00295"></a>00295                   <span class="keywordflow">try</span>
<a name="l00296"></a>00296                   {
<a name="l00297"></a>00297                         $Provider = $this-&gt;<a class="code" href="classcontext__set__utilities__1__0__0.html#aaba663480107c5f265e7a841f28724d0">get_data_provider</a>( $Options , $this-&gt;Provider );
<a name="l00298"></a>00298                         
<a name="l00299"></a>00299                         <span class="keywordflow">if</span>( method_exists( $Provider , <span class="stringliteral">&#39;select_list&#39;</span> ) === <span class="keyword">false</span> )
<a name="l00300"></a>00300                         {
<a name="l00301"></a>00301                               $ClassName = $Provider ? get_class( $Provider ) : <span class="stringliteral">&#39;undefined_class&#39;</span>;
<a name="l00302"></a>00302                               <span class="keywordflow">throw</span>( <span class="keyword">new</span> Exception( <span class="stringliteral">&#39;Method &quot;select_list&quot; was not found in the class &quot;&#39;</span>.$ClassName.<span class="stringliteral">&quot;&#39;&quot;</span> ) );
<a name="l00303"></a>00303                         }
<a name="l00304"></a>00304                         
<a name="l00305"></a>00305                         $Records = call_user_func( array( $Provider , <span class="stringliteral">&#39;select_list&#39;</span> ) , implode( <span class="charliteral">&#39;,&#39;</span> , $IdList ) );
<a name="l00306"></a>00306 
<a name="l00307"></a>00307                         <span class="keywordflow">return</span>( $Records );
<a name="l00308"></a>00308                   }
<a name="l00309"></a>00309                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00310"></a>00310                   {
<a name="l00311"></a>00311                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00312"></a>00312                   }
<a name="l00313"></a>00313             }
<a name="l00314"></a>00314       
<a name="l00341"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#ae290f29c9fac5bf08b414d211841693e">00341</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#ae290f29c9fac5bf08b414d211841693e">get_data_record</a>( &amp;$Options , $IdList )
<a name="l00342"></a>00342             {
<a name="l00343"></a>00343                   <span class="keywordflow">try</span>
<a name="l00344"></a>00344                   {
<a name="l00345"></a>00345                         $Records = $this-&gt;<a class="code" href="classcontext__set__utilities__1__0__0.html#a9fea23a40bcc90e270cea9bd5512f011">get_original_records</a>( $Options , $IdList );
<a name="l00346"></a>00346                         
<a name="l00347"></a>00347                         $Record = $Records[ 0 ];
<a name="l00348"></a>00348                         
<a name="l00349"></a>00349                         <span class="keywordflow">if</span>( intval( $Options-&gt;get_setting( <span class="stringliteral">&#39;massive_processing&#39;</span> , 1 ) ) )
<a name="l00350"></a>00350                         {
<a name="l00351"></a>00351                               $c = count( $Records );
<a name="l00352"></a>00352                               <span class="keywordflow">for</span>( $i = 1 ; $i &lt; $c ; $i++ )
<a name="l00353"></a>00353                               {
<a name="l00354"></a>00354                                     <span class="keywordflow">foreach</span>( $Records[ $i ] as $k =&gt; $v )
<a name="l00355"></a>00355                                     {
<a name="l00356"></a>00356                                           <span class="keywordflow">if</span>( <a class="code" href="functional__programming_8php.html#a113f39218a0e805d475fbc5ab87a16ab">get_field</a>( $Record , $k ) !== $v )
<a name="l00357"></a>00357                                           {
<a name="l00358"></a>00358                                                 <a class="code" href="functional__programming_8php.html#aeb504a5f142413c2643d5e8f315978e5">set_field</a>( $Record , $k , <span class="keyword">false</span> );
<a name="l00359"></a>00359                                           }
<a name="l00360"></a>00360                                     }
<a name="l00361"></a>00361                               }
<a name="l00362"></a>00362                         }
<a name="l00363"></a>00363                         
<a name="l00364"></a>00364                         <span class="keywordflow">return</span>( $Record );
<a name="l00365"></a>00365                   }
<a name="l00366"></a>00366                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00367"></a>00367                   {
<a name="l00368"></a>00368                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00369"></a>00369                   }
<a name="l00370"></a>00370             }
<a name="l00371"></a>00371             
<a name="l00406"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a76f5c7d13b6d189892138399ce171c4a">00406</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a76f5c7d13b6d189892138399ce171c4a">extract_data_from_request</a>( &amp;$Options , $Record , $SettingName , $Prefix )
<a name="l00407"></a>00407             {
<a name="l00408"></a>00408                   <span class="keywordflow">try</span>
<a name="l00409"></a>00409                   {
<a name="l00410"></a>00410                         <span class="keywordflow">if</span>( $Options-&gt;get_setting( $SettingName , <span class="keyword">false</span> ) )
<a name="l00411"></a>00411                         {
<a name="l00412"></a>00412                               $PostedRecord = $this-&gt;Security-&gt;parse_http_parameters( $Options-&gt;get_setting( $SettingName ) );
<a name="l00413"></a>00413                               
<a name="l00414"></a>00414                               <span class="keywordflow">foreach</span>( $PostedRecord as $k =&gt; $v )
<a name="l00415"></a>00415                               {
<a name="l00416"></a>00416                                     $k = str_replace( $Prefix.<span class="charliteral">&#39;_&#39;</span> , <span class="stringliteral">&#39;&#39;</span> , $k );
<a name="l00417"></a>00417                                     
<a name="l00418"></a>00418                                     <span class="keywordflow">if</span>( $v !== <span class="keyword">false</span> )
<a name="l00419"></a>00419                                     {
<a name="l00420"></a>00420                                           <a class="code" href="functional__programming_8php.html#aeb504a5f142413c2643d5e8f315978e5">set_field</a>( $Record , $k , $v );
<a name="l00421"></a>00421                                     }
<a name="l00422"></a>00422                               }
<a name="l00423"></a>00423                         }
<a name="l00424"></a>00424                         
<a name="l00425"></a>00425                         <span class="keywordflow">return</span>( $Record );
<a name="l00426"></a>00426                   }
<a name="l00427"></a>00427                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00428"></a>00428                   {
<a name="l00429"></a>00429                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00430"></a>00430                   }
<a name="l00431"></a>00431             }
<a name="l00432"></a>00432       
<a name="l00455"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#aaba663480107c5f265e7a841f28724d0">00455</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#aaba663480107c5f265e7a841f28724d0">get_data_provider</a>( &amp;$Options , &amp;$DefaultProvider )
<a name="l00456"></a>00456             {
<a name="l00457"></a>00457                   <span class="keywordflow">try</span>
<a name="l00458"></a>00458                   {
<a name="l00459"></a>00459                         <span class="keywordflow">if</span>( $Options-&gt;get_setting( <span class="stringliteral">&#39;access_package_name&#39;</span> , <span class="keyword">false</span> ) )
<a name="l00460"></a>00460                         {
<a name="l00461"></a>00461                               $PackageName = $Options-&gt;get_setting( <span class="stringliteral">&#39;access_package_name&#39;</span> );
<a name="l00462"></a>00462                               $PackageVersion = $Options-&gt;get_setting( <span class="stringliteral">&#39;access_package_version&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> );
<a name="l00463"></a>00463                               
<a name="l00464"></a>00464                               <span class="keywordflow">return</span>( <a class="code" href="core__public__api_8php.html#a3ba50cf690fa88e981b38b4779f18759">get_package</a>( $PackageName , $PackageVersion , __FILE__ ) );
<a name="l00465"></a>00465                         }
<a name="l00466"></a>00466                         <span class="keywordflow">else</span>
<a name="l00467"></a>00467                         {
<a name="l00468"></a>00468                               <span class="keywordflow">return</span>( $DefaultProvider );
<a name="l00469"></a>00469                         }
<a name="l00470"></a>00470                   }
<a name="l00471"></a>00471                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00472"></a>00472                   {
<a name="l00473"></a>00473                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00474"></a>00474                   }
<a name="l00475"></a>00475             }
<a name="l00476"></a>00476       
<a name="l00499"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a0a61389e24d2fc001a0ba6c0987ced03">00499</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a0a61389e24d2fc001a0ba6c0987ced03">get_posted_ids</a>( $Prefix )
<a name="l00500"></a>00500             {
<a name="l00501"></a>00501                   <span class="keywordflow">try</span>
<a name="l00502"></a>00502                   {
<a name="l00503"></a>00503                         <span class="keywordflow">if</span>( $this-&gt;Security-&gt;get_gp( $Prefix.<span class="stringliteral">&#39;_record_id&#39;</span> , <span class="stringliteral">&#39;command&#39;</span> , <span class="keyword">false</span> ) !== <span class="keyword">false</span> &amp;&amp; 
<a name="l00504"></a>00504                               $this-&gt;Security-&gt;get_gp( $Prefix.<span class="stringliteral">&#39;_record_id&#39;</span> , <span class="stringliteral">&#39;command&#39;</span> ) != -1 )
<a name="l00505"></a>00505                         {
<a name="l00506"></a>00506                               $Ids = array( $this-&gt;Security-&gt;get_gp( $Prefix.<span class="stringliteral">&#39;_record_id&#39;</span> , <span class="stringliteral">&#39;command&#39;</span> ) );
<a name="l00507"></a>00507                         }
<a name="l00508"></a>00508                         <span class="keywordflow">else</span>
<a name="l00509"></a>00509                         {
<a name="l00510"></a>00510                               $Ids = $this-&gt;Security-&gt;get_global( <span class="stringliteral">&#39;_id_&#39;</span> , <span class="stringliteral">&#39;string&#39;</span> , <a class="code" href="supported__data__types_8php.html#a2c9446b0caa0abd22b281dff4ae99b4a">POST</a> | <a class="code" href="supported__data__types_8php.html#a2a724336cba2ace70ee53f8fa37b8919">PREFIX_NAME</a> | <a class="code" href="supported__data__types_8php.html#a917cb2ad6b731b390f8c57aa48656211">KEYS</a> , array() );
<a name="l00511"></a>00511                         }
<a name="l00512"></a>00512                         
<a name="l00513"></a>00513                         <span class="keywordflow">return</span>( $Ids );
<a name="l00514"></a>00514                   }
<a name="l00515"></a>00515                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00516"></a>00516                   {
<a name="l00517"></a>00517                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00518"></a>00518                   }
<a name="l00519"></a>00519             }
<a name="l00520"></a>00520             
<a name="l00543"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#ad00fd0fe19af15dbc70244306caa1243">00543</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#ad00fd0fe19af15dbc70244306caa1243">process_redirect</a>( &amp;$Options , $AutoRedirect )
<a name="l00544"></a>00544             {
<a name="l00545"></a>00545                   <span class="keywordflow">try</span>
<a name="l00546"></a>00546                   {
<a name="l00547"></a>00547                         $AutoRedirect = intval( $Options-&gt;get_setting( <span class="stringliteral">&#39;auto_redirect&#39;</span> , $AutoRedirect ) );
<a name="l00548"></a>00548                         $AutoRedirect = $this-&gt;Security-&gt;get_gp( <span class="stringliteral">&#39;auto_redirect&#39;</span> , <span class="stringliteral">&#39;integer&#39;</span> , $AutoRedirect );
<a name="l00549"></a>00549                         <span class="keywordflow">if</span>( $AutoRedirect &amp;&amp; $this-&gt;Security-&gt;get_srv( <span class="stringliteral">&#39;HTTP_REFERER&#39;</span> , <span class="stringliteral">&#39;set&#39;</span> ) )
<a name="l00550"></a>00550                         {
<a name="l00551"></a>00551                               header( $_SERVER[ <span class="stringliteral">&#39;SERVER_PROTOCOL&#39;</span> ].<span class="stringliteral">&#39; 303 See Other&#39;</span> );
<a name="l00552"></a>00552                               <span class="keywordflow">if</span>( $Options-&gt;get_setting( <span class="stringliteral">&#39;redirect_page&#39;</span> , <span class="keyword">false</span> ) )
<a name="l00553"></a>00553                               {
<a name="l00554"></a>00554                                     header( <span class="stringliteral">&quot;Location: &quot;</span>.$Options-&gt;get_setting( <span class="stringliteral">&#39;redirect_page&#39;</span> ) );
<a name="l00555"></a>00555                               }
<a name="l00556"></a>00556                               <span class="keywordflow">else</span>
<a name="l00557"></a>00557                               {
<a name="l00558"></a>00558                                     header( <span class="stringliteral">&quot;Location: &quot;</span>.$this-&gt;Security-&gt;get_srv( <span class="stringliteral">&#39;HTTP_REFERER&#39;</span> , <span class="stringliteral">&#39;raw&#39;</span> ) );
<a name="l00559"></a>00559                               }
<a name="l00560"></a>00560                               exit( 0 );
<a name="l00561"></a>00561                         }
<a name="l00562"></a>00562                   }
<a name="l00563"></a>00563                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00564"></a>00564                   {
<a name="l00565"></a>00565                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00566"></a>00566                   }
<a name="l00567"></a>00567             }
<a name="l00568"></a>00568             
<a name="l00595"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#aade5096bdc7c9d75802a093a8f940e2d">00595</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#aade5096bdc7c9d75802a093a8f940e2d">set_form_data</a>( $Form , $Data )
<a name="l00596"></a>00596             {
<a name="l00597"></a>00597                   <span class="keywordflow">try</span>
<a name="l00598"></a>00598                   {
<a name="l00599"></a>00599                         $BlockSettings = <a class="code" href="core__public__api_8php.html#a7dbfff8b452767e03ec52155dff6bdd3">get_package_object</a>( <span class="stringliteral">&#39;settings::settings&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00600"></a>00600                         <span class="keywordflow">for</span>( ; $Parameters = $this-&gt;String-&gt;get_macro_parameters( $Form , <span class="stringliteral">&#39;form_value&#39;</span> ) ; )
<a name="l00601"></a>00601                         {
<a name="l00602"></a>00602                               $BlockSettings-&gt;load_settings( $Parameters );
<a name="l00603"></a>00603                               $Name = $BlockSettings-&gt;get_setting( <span class="stringliteral">&#39;name&#39;</span> );
<a name="l00604"></a>00604                               $Type = $BlockSettings-&gt;get_setting( <span class="stringliteral">&#39;type&#39;</span> , <span class="stringliteral">&#39;string&#39;</span> );
<a name="l00605"></a>00605                               
<a name="l00606"></a>00606                               <span class="keywordflow">if</span>( $this-&gt;Security-&gt;get_gp( $Name , <span class="stringliteral">&#39;set&#39;</span> ) )
<a name="l00607"></a>00607                               {
<a name="l00608"></a>00608                                     $Value = $this-&gt;Security-&gt;get_gp( $Name , $Type );
<a name="l00609"></a>00609                               }
<a name="l00610"></a>00610                               <span class="keywordflow">else</span>
<a name="l00611"></a>00611                               {
<a name="l00612"></a>00612                                     $Value = <a class="code" href="functional__programming_8php.html#a113f39218a0e805d475fbc5ab87a16ab">get_field</a>( $Data , $Name );
<a name="l00613"></a>00613                               }
<a name="l00614"></a>00614 
<a name="l00615"></a>00615                               <span class="keywordflow">if</span>( is_array( $Value ) )
<a name="l00616"></a>00616                               {
<a name="l00617"></a>00617                                     $Value = serialize( $Value );
<a name="l00618"></a>00618                                     $Value = $this-&gt;Security-&gt;get( $Value , <span class="stringliteral">&#39;string&#39;</span> );
<a name="l00619"></a>00619                               }
<a name="l00620"></a>00620                               
<a name="l00621"></a>00621                               $Form = str_replace( <span class="stringliteral">&quot;{form_value:$Parameters}&quot;</span> , $Value , $Form );
<a name="l00622"></a>00622                         }
<a name="l00623"></a>00623                         
<a name="l00624"></a>00624                         $Form = $this-&gt;String-&gt;print_record( $Form , $Data );
<a name="l00625"></a>00625                         <span class="keywordflow">foreach</span>( $Data as $k =&gt; $v )
<a name="l00626"></a>00626                         {
<a name="l00627"></a>00627                               <span class="keywordflow">if</span>( is_array( $v ) === <span class="keyword">false</span> &amp;&amp; is_object( $v ) === <span class="keyword">false</span> )
<a name="l00628"></a>00628                               {
<a name="l00629"></a>00629                                     $Form = str_replace( <span class="charliteral">&#39;{&#39;</span>.$k.<span class="stringliteral">&#39;_original}&#39;</span> , $v , $Form );
<a name="l00630"></a>00630                               }
<a name="l00631"></a>00631                         }
<a name="l00632"></a>00632                         
<a name="l00633"></a>00633                         <span class="keywordflow">return</span>( $Form );
<a name="l00634"></a>00634                   }
<a name="l00635"></a>00635                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00636"></a>00636                   {
<a name="l00637"></a>00637                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00638"></a>00638                   }
<a name="l00639"></a>00639             }
<a name="l00640"></a>00640             
<a name="l00667"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#a0d60f227bf0e1669d73f9cb293570b09">00667</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#a0d60f227bf0e1669d73f9cb293570b09">set_grid_data</a>( $Options , &amp;$Paging , $QueryString = <span class="stringliteral">&#39;1 = 1&#39;</span> )
<a name="l00668"></a>00668             {
<a name="l00669"></a>00669                   <span class="keywordflow">try</span>
<a name="l00670"></a>00670                   {
<a name="l00671"></a>00671                         $SelectPackageName = $Options-&gt;get_setting( <span class="stringliteral">&#39;access_package_name&#39;</span> );
<a name="l00672"></a>00672                         $SelectPackageVersion = $Options-&gt;get_setting( <span class="stringliteral">&#39;access_package_version&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> );
<a name="l00673"></a>00673                         $SelectFunction = $Options-&gt;get_setting( <span class="stringliteral">&#39;select_func&#39;</span> , <span class="stringliteral">&#39;select&#39;</span> );
<a name="l00674"></a>00674                         
<a name="l00675"></a>00675                         $Paging-&gt;set( <span class="stringliteral">&#39;DataAccessor&#39;</span> , create_function( <span class="stringliteral">&#39;$Start , $Limit , $Field , $Order , $Options&#39;</span> , 
<a name="l00676"></a>00676                               <span class="stringliteral">&quot;\$Object = get_package( &#39;$SelectPackageName&#39; , &#39;$SelectPackageVersion&#39; , __FILE__ );</span>
<a name="l00677"></a>00677 <span class="stringliteral">                              return( \$Object-&gt;$SelectFunction( \$Start , \$Limit , \$Field , \$Order , </span>
<a name="l00678"></a>00678 <span class="stringliteral">                              \&quot;$QueryString\&quot; , \$Options ) );&quot;</span> ) );
<a name="l00679"></a>00679                         
<a name="l00680"></a>00680                         <span class="keywordflow">if</span>( $Options-&gt;get_setting( <span class="stringliteral">&#39;draw_package_name&#39;</span> , <span class="keyword">false</span> ) )
<a name="l00681"></a>00681                         {
<a name="l00682"></a>00682                               $DrawPackageName = $Options-&gt;get_setting( <span class="stringliteral">&#39;draw_package_name&#39;</span> );
<a name="l00683"></a>00683                               $DrawPackageVersion = $Options-&gt;get_setting( <span class="stringliteral">&#39;draw_package_version&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> );
<a name="l00684"></a>00684                               $DrawFunction = $Options-&gt;get_setting( <span class="stringliteral">&#39;draw_func&#39;</span> , <span class="stringliteral">&#39;select&#39;</span> );
<a name="l00685"></a>00685                               
<a name="l00686"></a>00686                               $Paging-&gt;set( <span class="stringliteral">&#39;CallbackFunc&#39;</span> , create_function( <span class="stringliteral">&#39;$Template , $Record&#39;</span> , 
<a name="l00687"></a>00687                                     <span class="stringliteral">&quot;\$Object = get_package( &#39;$DrawPackageName&#39; , &#39;$DrawPackageVersion&#39; , __FILE__ );</span>
<a name="l00688"></a>00688 <span class="stringliteral">                                    return( \$Object-&gt;$DrawFunction( \$Template , \$Record ) );&quot;</span> ) );
<a name="l00689"></a>00689                         }
<a name="l00690"></a>00690                   }
<a name="l00691"></a>00691                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00692"></a>00692                   {
<a name="l00693"></a>00693                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00694"></a>00694                   }
<a name="l00695"></a>00695             }
<a name="l00696"></a>00696                         
<a name="l00731"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#ac9c5b0ee38ea6053631bf8c1ba047003">00731</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#ac9c5b0ee38ea6053631bf8c1ba047003">get_form</a>( &amp;$Options , $IdList , $FormFileName , $Prefix )
<a name="l00732"></a>00732             {
<a name="l00733"></a>00733                   <span class="keywordflow">try</span>
<a name="l00734"></a>00734                   {
<a name="l00735"></a>00735                         $FormFileName = $Options-&gt;get_setting( <span class="stringliteral">&#39;form_template&#39;</span> , $FormFileName );
<a name="l00736"></a>00736                         $FormFilePath = dirname( $Options-&gt;get_setting( <span class="stringliteral">&#39;file_path&#39;</span> ) ).<span class="stringliteral">&quot;/res/templates/$FormFileName.tpl&quot;</span>;
<a name="l00737"></a>00737                         $Form = $this-&gt;CachedMultyFS-&gt;file_get_contents( $FormFilePath );
<a name="l00738"></a>00738                         $Form = str_replace( <span class="stringliteral">&#39;{prefix}&#39;</span> , $Prefix , $Form );
<a name="l00739"></a>00739                         $Form = str_replace( <span class="stringliteral">&#39;{state}&#39;</span> , <span class="stringliteral">&#39;update_record&#39;</span> , $Form );
<a name="l00740"></a>00740                         $Form = str_replace( <span class="stringliteral">&#39;{ids}&#39;</span> , implode( <span class="charliteral">&#39;,&#39;</span> , $IdList ) , $Form );
<a name="l00741"></a>00741                         
<a name="l00742"></a>00742                         <span class="keywordflow">return</span>( $Form );
<a name="l00743"></a>00743                   }
<a name="l00744"></a>00744                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00745"></a>00745                   {
<a name="l00746"></a>00746                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00747"></a>00747                   }
<a name="l00748"></a>00748             }
<a name="l00749"></a>00749             
<a name="l00784"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#af7d8def26453ad37293f955ea8b5d71f">00784</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#af7d8def26453ad37293f955ea8b5d71f">get_common_state_config</a>( &amp;$Settings , $SettingName , $Default , $ComponentPath )
<a name="l00785"></a>00785             {
<a name="l00786"></a>00786                   <span class="keywordflow">try</span>
<a name="l00787"></a>00787                   {
<a name="l00788"></a>00788                         $CommonStateConfig = $Settings-&gt;get_setting( $SettingName , $Default );
<a name="l00789"></a>00789                         
<a name="l00790"></a>00790                         $CommonStateConfigPath = dirname( $ComponentPath ).<span class="stringliteral">&quot;/conf/$CommonStateConfig&quot;</span>;
<a name="l00791"></a>00791 
<a name="l00792"></a>00792                         <span class="keywordflow">if</span>( $this-&gt;CachedMultyFS-&gt;file_exists( $CommonStateConfigPath ) === false )
<a name="l00793"></a>00793                         {
<a name="l00794"></a>00794                               <span class="keywordflow">return</span>( <span class="keyword">false</span> );
<a name="l00795"></a>00795                         }
<a name="l00796"></a>00796                         
<a name="l00797"></a>00797                         $Config = $this-&gt;CachedMultyFS-&gt;file_get_contents( $CommonStateConfigPath );
<a name="l00798"></a>00798                         
<a name="l00799"></a>00799                         $Config = str_replace( <span class="stringliteral">&#39;{prefix}&#39;</span> , $Settings-&gt;get_setting( <span class="stringliteral">&#39;prefix&#39;</span> , <span class="stringliteral">&#39;&#39;</span> ) , $Config );
<a name="l00800"></a>00800                         
<a name="l00801"></a>00801                         <span class="keywordflow">return</span>( $Config );
<a name="l00802"></a>00802                   }
<a name="l00803"></a>00803                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00804"></a>00804                   {
<a name="l00805"></a>00805                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00806"></a>00806                   }
<a name="l00807"></a>00807             }
<a name="l00808"></a>00808             
<a name="l00843"></a><a class="code" href="classcontext__set__utilities__1__0__0.html#ab5c8b662d51301835041db4ea58f5740">00843</a>             function                <a class="code" href="classcontext__set__utilities__1__0__0.html#ab5c8b662d51301835041db4ea58f5740">load_common_state_config</a>( $Settings , $SettingName , $Default , $ComponentPath )
<a name="l00844"></a>00844             {
<a name="l00845"></a>00845                   <span class="keywordflow">try</span>
<a name="l00846"></a>00846                   {
<a name="l00847"></a>00847                         $Config = $this-&gt;<a class="code" href="classcontext__set__utilities__1__0__0.html#af7d8def26453ad37293f955ea8b5d71f">get_common_state_config</a>( $Settings , $SettingName , $Default , $ComponentPath );
<a name="l00848"></a>00848 
<a name="l00849"></a>00849                         $CommonButtonConfig = <a class="code" href="core__public__api_8php.html#a7dbfff8b452767e03ec52155dff6bdd3">get_package_object</a>( <span class="stringliteral">&#39;settings::settings&#39;</span> , <span class="stringliteral">&#39;last&#39;</span> , __FILE__ );
<a name="l00850"></a>00850 
<a name="l00851"></a>00851                         $CommonButtonConfig-&gt;load_settings( $Config );
<a name="l00852"></a>00852 
<a name="l00853"></a>00853                         <span class="keywordflow">return</span>( $CommonButtonConfig );
<a name="l00854"></a>00854                   }
<a name="l00855"></a>00855                   <span class="keywordflow">catch</span>( Exception $e )
<a name="l00856"></a>00856                   {
<a name="l00857"></a>00857                         $a = func_get_args();<a class="code" href="core__utilities_8php.html#abfba210aa5ad8e9a273b3342263c2961">_throw_exception_object</a>( __METHOD__ , $a , $e );
<a name="l00858"></a>00858                   }
<a name="l00859"></a>00859             }
<a name="l00860"></a>00860       }
<a name="l00861"></a>00861       
<a name="l00862"></a>00862 ?&gt;
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 3 2011 14:49:50 for ultimix by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
